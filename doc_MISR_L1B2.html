<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
   <head>
      <meta http-equiv="content-type" content="text/html; charset=utf-8">
      <title>Documentation for the IDL routines in project MISR_L1B2</title>
   </head>
<body>
<h1>Documentation for the IDL routines in project MISR_L1B2</h1>
<h2>avail_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This program saves information on the availability of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance files in either Global or Local Mode on the current computer at the time of execution.</p></li>
<li><p><strong>Algorithm:</strong> This program (1) relies on the function <code>avail_l1b2_data</code> to search for and report on the availability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance files in either Global (<span class="smallcaps">GM</span>) or Local Mode (<span class="smallcaps">LM</span>) on the computer executing this program, and (2) saves the information in a log file located in the specified or default folder.</p></li>
<li><p><strong>Syntax:</strong> <code>avail_l1b2_gm, misr_mode, $</code><br />
<code>L1B2_FOLDER = l1b2_folder, L1B2_VERSION = l1b2_version, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> A 2-character parameter indicating whether to report on the availability of Global (<code>GM</code>) or Local (<code>LM</code>) Mode files.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2_FOLDER = l1b2_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2_VERSION = l1b2_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>OUT_FOLDER = out_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the output file.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> N/A.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, the keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. An output file named <code>Avail_L1B2_rad_&#8217; + [misr_mode] + &#8217;_&#8217; + [comp_name] + &#8217;_MISR-Mission_&#8217; + date + &#8217;.txt&#8217;</code> and located in the default or the specified output folder contains information on the availability of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files of the specified <span class="smallcaps">MODE</span> in the folders of <code>root_dirs[1]</code> on the computer <code>comp_name</code> at the time of execution <code>[creation_date]</code>.</p></li>
<li><p>If an exception condition has been detected, the optional output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered and this program prints out the error message if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output file may be inexistent, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: Unrecognized <code>misr_mode</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameters <code>l1b2_folder</code> is not specified.</p></li>
<li><p>Error 300: No directories containing <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files of the specified <span class="smallcaps">Mode</span> have been found at the specified or default locations on this computer.</p></li>
<li><p>Error 400: The directory <code>out_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in <code>avail_l1b2_data.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>avail_l1b2_data.pro</code></p></li>
<li><p><code>chk_misr_mode.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This program works equally well with <span class="smallcaps">GM</span> and <span class="smallcaps">LM</span> files.</p></li>
<li><p><strong>Note 2:</strong> This program currently reports on the first and last <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data files of the specified <span class="smallcaps">Mode</span> found in the specified or default places on this computer. It does not verify the availability of all 9 <span class="smallcaps">L1B2</span> files per <span class="smallcaps">Orbit</span>, or of the associated Geometric Parameters and <span class="smallcaps">L2</span> Land Surface files, which are also required by the <span class="smallcaps">MISR-HR</span> processing system. Nor does it report on the version status of the data files.</p></li>
<li><p><strong>Note 3:</strong> Assuming (1) that the <span class="smallcaps">L1B2</span> Geometric Parameters Product (<span class="smallcaps">GPP</span>) and <span class="smallcaps">L2</span> Land Surface Product (<span class="smallcaps">LSP</span>) files are systematically acquired together with the <span class="smallcaps">L1B2</span> <span class="smallcaps">GRP</span> files, (2) that the standard Ancillary Geographic Product (<span class="smallcaps">AGP</span>) files for those <span class="smallcaps">Paths</span> are available, and (3) that the acquisition of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> <span class="smallcaps">GRP</span> files include complete <span class="smallcaps">Orbits</span> (as opposed to subsets of one or a few <span class="smallcaps">Blocks</span>), this program reports on the spatial domain and temporal range for which <span class="smallcaps">MISR-HR</span> products derived from the Global Mode data can be generated on this computer.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[On MicMac2:]

IDL&gt; avail_l1b2, &#39;GM&#39;, /VERBOSE, /DEBUG, EXCPT_COND = excpt_cond
The output file
Avail_L1B2_rad_GM_MISR-Mission_2018-12-26.txt
has been created in the folder
~/MISR_HR/Outcomes/Available/L1B2_GM
IDL&gt; SPAWN, &#39;cat ~/MISR_HR/Outcomes/Available/L1B2_GM/
   File name: Avail_L1B2_rad_GM_MISR-Mission_2018-12-26.txt
 Folder name: ~/MISR_HR/Outcomes/Available/L1B2_GM/
Generated by: AVAIL_L1B2
Generated on: MicMac2
    Saved on: 2018-12-26 at 20:48:45

  Content: MISR L1B2 GM data availability

                Directory names Sizes # files      From          To
                --------------- ----- -------      ----          --
/Volumes/MISR_Data3/P168/L1_GM/  632G  3582  2000-03-24  2017-11-18
/Volumes/MISR_Data3/P169/L1_GM/  560G  3159  2000-02-28  2015-11-20
/Volumes/MISR_Data3/P170/L1_GM/  558G  3177  2000-03-06  2015-11-27
/Volumes/MISR_Data3/P171/L1_GM/  546G  3137  2000-02-26  2015-11-18
/Volumes/MISR_Data3/P176/L1_GM/  542G  3150  2000-02-29  2015-11-21</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;-07&#8211;-24: Version 0.8 &#8212;&#8211; Initial release, under the name <code>avail_l1b2_gm.pro</code>.</p></li>
<li><p>2017&#8211;-12&#8211;-18: Version 0.9 &#8212;&#8211; Update Output format.</p></li>
<li><p>2018-&#8211;01&#8211;-30: Version 1.0 &#8211;&#8212; Initial public release.</p></li>
<li><p>2018-&#8211;04-&#8211;08: Version 1.1 &#8211;&#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018-&#8211;05-&#8211;03: Version 1.2 &#8211;&#8212; Merge this function with its twin <code>avail_l1b2_lm.pro</code> and change the name to <code>avail_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;-05&#8211;-14: Version 1.3 &#8211;&#8212; Update this function to use the revised version of <code>is_writable.pro</code> and update the documentation.</p></li>
<li><p>2018-&#8211;05-&#8211;18: Version 1.5 &#8211;&#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;-07&#8211;-05: Version 1.6 &#8211;&#8212; Update this routine to rely on the new function <code>get_host_info.pro</code> and the updated version of the function <code>set_root_dirs.pro</code>.</p></li>
<li><p>2018&#8211;-12&#8211;24: Version 1.7 &#8212; Update this routine to rely on the new function<br />
<code>set_roots_vers.pro</code>.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.01 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;06-11: Version 2.02 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements, add the version identifier to the output file and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;12&#8211;19: Version 2.1.1 &#8212; Bug fix (replace <code>RETURN</code> by <code>STOP</code> statements).</p></li>
</ul></li>
</ul>
<h2>avail_l1b2_data</h2>
<ul>
<li><p><strong>Purpose:</strong> This function reports on the availability of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Global or Local Mode data files in the subdirectories matching the <code>IDL</code> regular expression <code>path_pattern</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function searches the directory addresses matching the pattern <code>path_pattern</code> for <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files of the specified <span class="smallcaps">Mode</span>, and stores information on their names, sizes and range of temporal coverage in the output positional parameter structure <code>misr_l1b2_data</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = avail_l1b2_data(misr_mode, path_pattern, $</code><br />
<code>misr_l1b2_data, VERBOSE = verbose, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> A 2-character parameter indicating whether to report on the availability of Global (<code>GM</code>) or Local (<code>LM</code>) Mode files.</p></li>
<li><p><code>path_pattern {STRING} [I]:</code> A path pattern presumed to contain <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data files.</p></li>
<li><p><code>misr_l1b2_data {STRUCTURE} [O]:</code> A structure containing the names of the subdirectories of <code>path_pattern</code> containing <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, the total size of files in those directories, and the range of dates covered by these data.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_l1b2_data</code> is a structure containing information on the availability of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files in the appropriate folders of <code>root_dirs[1]</code> at the time of execution.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>misr_l1b2_data</code> may be empty, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 120: Positional parameter <code>path_pattern</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>get_dirs_sizes</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2date</code> when processing the first available <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>orbit2date</code> when processing the last available <span class="smallcaps">Orbit</span>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_mode.pro</code></p></li>
<li><p><code>get_dirs_sizes.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function currently reports on the first and last <span class="smallcaps">MISR</span> files of the specified <span class="smallcaps">Mode</span> found in each of the subdirectories matching <code>path_pattern</code>. It does not verify the availability of all 9 <span class="smallcaps">L1B2</span> files per <span class="smallcaps">Orbit</span>, or of the associated <span class="smallcaps">L2</span> Land Surface and the Geometric Parameters files, which are also required by the <span class="smallcaps">MISR-HR</span> processing system.</p></li>
<li><p><strong>Note 2:</strong> In general, there may not be continuous coverage between the first and last reported dates: <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> <span class="smallcaps">GM</span> files may be occasionally missing for technical reasons, and <span class="smallcaps">L1B2</span> <span class="smallcaps">LM</span> files may only be acquired occasionally on a given site, or on different sites on the same <span class="smallcaps">Orbit</span> at different dates.</p></li>
<li><p><strong>Note 3:</strong> For generic purposes, and in particular to save this information in a local file, use the program <code>avail_l1b2.pro</code> instead of this function.</p></li>
<li><p><strong>Note 4:</strong> No exception conditions are raised if no <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data of the specified <span class="smallcaps">Mode</span> are found on this computer; a warning message is printed on the console only if the input keyword parameter <code>VERBOSE</code> is set to at least <code>1</code>.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[On MicMac2:]

IDL&gt; rc = set_roots_vers(root_dirs, versions, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; misr_mode = &#39;GM&#39;
IDL&gt; dir_patt = root_dirs[1] + &#39;P*/L1_&#39; + misr_mode + &#39;/&#39;
IDL&gt; rc = avail_l1b2_data(misr_mode, dir_patt, $
   misr_l1b2_data, /VERBOSE, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, strstr(rc), &#39;, excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0, excpt_cond = &gt;&lt;
IDL&gt; PRINT, misr_l1b2_data.DIRNAMES
/Volumes/MISR_Data0/P167/L1_GM/
/Volumes/MISR_Data0/P168/L1_GM/
/Volumes/MISR_Data0/P169/L1_GM/
/Volumes/MISR_Data0/P170/L1_GM/
/Volumes/MISR_Data0/P171/L1_GM/
/Volumes/MISR_Data0/P172/L1_GM/
/Volumes/MISR_Data0/P173/L1_GM/
IDL&gt; PRINT, misr_l1b2_data.DIRSIZES
671G 682G 680G 677G 657G 672G 667G</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;24: Version 0.9 &#8212; Initial release, under the name <code>avail_l1b2_gm_data</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;05&#8211;04: Version 1.1 &#8212; Merge this function with its twin<br />
<code>avail_l1b2_lm_data.pro</code> and change the name to <code>avail_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;-12&#8211;24: Version 1.6 &#8212; Update this routine to rely on the new function<br />
<code>set_roots_vers.pro</code>.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.01 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.02 &#8212; Update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>best_fits_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates statistical information, including best linear fits, that can be used to estimate replacement values for poor or bad (missing) values in the target <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> radiance array identified by the selected <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, <span class="smallcaps">Block</span>, <span class="smallcaps">Camera</span> and <span class="smallcaps">Band</span>, based on non-missing values available in one of the other 35 source (camera and band) radiance data channels for the same <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> data acquisition.</p></li>
<li><p><strong>Algorithm:</strong> This function computes the Pearson correlation coefficients, best linear fits and associated statistical parameters between the target data channel radiance and all other (35) source data channel radiances available for the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> data acquisition. Depending on the value of the input positional parameter <code>n_masks</code>, these statistics may be computed for all available values in the source and target data channels (<code>n_masks</code> set to 1), separately for land masses and water bodies (<code>n_masks</code> set to 2), or separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = best_fits_l1b2(misr_ptr, rad_ptr, rdqi_ptr, $</code><br />
<code>target_camera, target_band, n_masks, lwc_mask_ptr, best_fits, $</code><br />
<code>TEST_ID = test_id, LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>SCATT_IT = scatt_it, SCATT_FOLDER = scatt_folder, $</code><br />
<code>SET_MIN_SCATT = set_min_scatt, SET_MAX_SCATT = set_max_scatt, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [O]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 4 pointer arrays.</p></li>
<li><p><code>rad_ptr {POINTER array} [O]:</code> The array of 36 pointers to the data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> radiance values, in the native order (DF to DA).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [O]:</code> The array of 36 pointers to the data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF to DA).</p></li>
<li><p><code>target_camera {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Camera</span> (target).</p></li>
<li><p><code>target_band {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Band</span> (target).</p></li>
<li><p><code>n_masks {INTEGER} [I]:</code> The number of masks to use: <code>1</code> to compute bulk statistics for all geophysical target types, <code>2</code> to compute statistics separately for land masses and water bodies, or <code>3</code> to compute statistics separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><code>lwc_mask_ptr {POINTER array} [O]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the <code>BYTE</code> masks containing the information on the spatial distribution of geophysical media to consider, as defined by <code>n_masks</code>.</p></li>
<li><p><code>best_fits {STRUCTURE} [O]:</code> The output structure containing the desired statistical information.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> String to designate a particular experiment (e.g., to test the performance of the algorithm). This optional input keyword parameter has no effect on the computing carried out by this function, but modifies (when not a null string) the name of the folders that contain the log file and the scatterplots, so that the results can be compared to other cases.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>SCATT_IT = scatt_it {INT} [I] (Default value: 0):</code> Flag to generate (1) or skip (0) a scatterplot of the two best correlated data channels for each of the cases specified by <code>n_masks</code>.</p></li>
<li><p><code>SCATT_FOLDER = scatt_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the scatterplots.</p></li>
<li><p><code>SET_MIN_SCATT = set_min_scatt {STRING} [I] (Default value: None):</code> The minimum value to be used on the <code>X</code> and <code>Y</code> axes of the scatterplots. WARNING: This value must be provided as a <code>STRING</code> because the value <code>0.0</code> is frequently desirable as the minimum for the scatterplot, but that numerical value would be misinterpreted as NOT setting the keyword.</p></li>
<li><p><code>SET_MAX_SCATT = set_max_scatt {STRING} [I] (Default value: None):</code> The maximum value to be used on the <code>X</code> and <code>Y</code> axes of the scatterplots. WARNING: By analogy with <code>set_min_scatt</code>, this value must be provided as a <code>STRING</code>.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. If the input positional parameter <code>n_masks</code> is set to <code>1</code>, all valid values that are common to the source and the target data channels are used; if it is set to <code>2</code>, those statistics are computed separately for the land areas and water bodies, as classified by the corresponding static <span class="smallcaps">MISR</span> <span class="smallcaps">AGP</span> maps; and if it is set to <code>3</code>, those statistics are computed separately for the clear land masses, the clear water bodies, and the cloudy fields in the scene. The output positional parameter <code>best_fits</code> contains the desired statistical information and the scatterplots as well as the log file have been saved if requested.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>best_fits</code> may be empty and the scatterplots as well as the log file may be inexistent, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_ptr</code> is not a pointer.</p></li>
<li><p>Error 120: The input positional parameter <code>rad_ptr</code> is not a pointer array.</p></li>
<li><p>Error 122: The input positional parameter <code>rdqi_ptr</code> is not a pointer array.</p></li>
<li><p>Error 130: Input positional parameter <code>target_camera</code> is invalid.</p></li>
<li><p>Error 132: Input positional parameter <code>target_band</code> is invalid.</p></li>
<li><p>Error 140: Input positional parameter <code>n_masks</code> is not an integer.</p></li>
<li><p>Error 142: The numerical value of the input positional parameter <code>n_masks</code> is invalid.</p></li>
<li><p>Error 150: The input positional parameter <code>lwc_mask_ptr</code> is not a pointer array.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 299: Unrecognized computer and alternate input or output folders not provided.</p></li>
<li><p>Error 400: The directory <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The directory <code>scatt_fpath</code> is unwritable.</p></li>
<li><p>Error 500: The dimensions of the target and the source data buffers are incompatible.</p></li>
<li><p>Error 510: An exception condition occurred in <code>plt_scatt_gen.pro</code> while generating scatterplots for land masses.</p></li>
<li><p>Error 520: An exception condition occurred in <code>plt_scatt_gen.pro</code> while generating scatterplots for water bodies.</p></li>
<li><p>Error 530: An exception condition occurred in <code>plt_scatt_gen.pro</code> while generating scatterplots for cloud fields.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_band.pro</code></p></li>
<li><p><code>chk_misr_camera.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>hr2lr.pro</code></p></li>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_integer.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>plt_scatt_gen.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>str2block.pro</code></p></li>
<li><p><code>str2orbit.pro</code></p></li>
<li><p><code>str2path.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function returns the results in decreasing order of the Pearson correlation coefficient between the source and the target.</p></li>
<li><p><strong>Note 2:</strong> If the optional keyword parameter <code>SCATT_IT</code> is set and either or both of the optional keyword parameters <code>SET_MIN_SCATT</code> and <code>SET_MAX_SCATT</code> are explicitly provided, the latter are used for both the <code>X</code> and the <code>Y</code> axes, and for all (up to 3) scatterplots simultaneously generated by this function: this facilitates comparisons, but may result in some of the data being clustered in a small subset of the imposed range. If these keywords are not set, the ranges are individually selected to optimize the visualization of the data in each figure.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39;GM&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 1412
IDL&gt; misr_block = 111
IDL&gt; n_targets = 3
IDL&gt; rccm_folder = &#39;&#39;
IDL&gt; rccm_version = &#39;&#39;
IDL&gt; debug = 1
IDL&gt; rc = mk_l1b2_masks(misr_mode, misr_path, misr_orbit, $
IDL&gt;    misr_block, n_targets, land_mask, water_mask, $
IDL&gt;    clear_land_masks, clear_water_masks, cloud_masks, $
IDL&gt;    RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $
IDL&gt;    DEBUG = debug, EXCPT_COND = excpt_cond)

IDL&gt; target_camera = &#39;AF&#39;
IDL&gt; target_band = &#39;Blue&#39;
IDL&gt; log_it = 1
IDL&gt; log_folder = &#39;&#39;
IDL&gt; scatt_it = 1
IDL&gt; scatt_folder = &#39;&#39;
IDL&gt; verbose = 2
IDL&gt; rc = best_fits_l1b2(misr_mode, misr_path, misr_orbit, $
IDL&gt;    misr_block, target_camera, target_band, n_targets, $
IDL&gt;    land_mask, water_mask, clear_land_masks, $
IDL&gt;    clear_water_masks, cloud_masks, best_fits, $
IDL&gt;    LOG_IT = log_it, LOG_FOLDER = log_folder, $
IDL&gt;    SCATT_IT = scatt_it, SCATT_FOLDER = scatt_folder, $
IDL&gt;    VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
The scatterplot has been saved in ~/MISR_HR/Outcomes/
   GM-P168-O001412-B111/BestFits/Bestfits_Nm3_ClearLand_.png
The scatterplot has been saved in ~/MISR_HR/Outcomes/
   GM-P168-O001412-B111/BestFits/Bestfits_Nm3_ClearWater_.png
The scatterplot has been saved in ~/MISR_HR/Outcomes/
   GM-P168-O001412-B111/BestFits/Bestfits_Nm3_Cloud_.png
The log file has been saved in ~/MISR_HR/Outcomes/
   GM-P168-O001412-B111/BestFits/Bestfits_Nmasks3_L1B2_Rad_
   GM-P168-O001412-B111_AF_Blue.txt</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;08&#8211;09: Version 0.8 &#8212; Initial release.</p></li>
<li><p>2018&#8211;09&#8211;19: Version 0.9 &#8212; Upgrade the code to compute the statistics only on valid data, i.e., where <code>Rad</code> &gt; 0.0 (as before) and <code>RDQI</code> &lt; 2 (new), and to generate nominal results whenever there are no common valid pixel values suitable to compute the statistics.</p></li>
<li><p>2019&#8211;01&#8211;26: Version 1.0 &#8212; Bug fixes and initial public release.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.11 &#8212; Update the code to use the more detailed masks generated by the latest version of <code>mk_l1b2_masks.pro</code>.</p></li>
<li><p>2019&#8211;04&#8211;18: Version 2.12 &#8212; Update the code to return negative values for the <code>RMSD</code> and <span class="math inline"><em>&#967;</em><sup>2</sup></span> statistics when there are no valid data available.</p></li>
<li><p>2019&#8211;06-11: Version 2.13 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;30: Version 2.1.1 &#8212; Add the optional keyword parameter <code>test_id</code> to facilitate saving the log file and the scatterplots in separate folders for testing purposes, change the definition of <code>best_land_chisqs</code>, <code>best_water_chisqs</code> and <code>best_cloud_chisqs</code> from <code>FLTARR</code> to <code>DBLARR</code> and update the code to use the current version of the function <code>hr2lr.pro</code>.</p></li>
</ul></li>
</ul>
<h2>cor_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function saves the results of the computation of the cross-correlation statistics between the 36 data channels of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) files, in the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, for a single <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> combination.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <code>IDL</code> function <code>cor_l1b2_block.pro</code> to carry out the computations, and saves the numerical results in an <code>IDL</code> <code>SAVE</code> file as well as in a plain text file. If the input data are from <span class="smallcaps">Global</span> <span class="smallcaps">Mode</span> files, this function also separately computes the correlations between the 12 high spatial resolution BRF fields.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = cor_l1b2(misr_mode, misr_path, misr_orbit, misr_block, $</code><br />
<code>L1B2_FOLDER = l1b2_folder, L1B2_VERSION = l1b2_version, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> mode.</p></li>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2_FOLDER = l1b2_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2_VERSION = l1b2_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. By default, this function generates and saves 2 files in the folder<br />
<code>root_dirs[3] + &#8217;/Pxxx_Oyyyyyy_Bzzz/L1B2_&#8217; + [misr_mode] + &#8217;/&#8217;</code>:</p>
<ul>
<li><p>1 plain text file containing the numerical results of the correlation computations, named<br />
<code>corr_Pxxx_Oyyyyyy_Bzzz_L1B2_[misr_mode]_toabrf_</code><br />
<code>[acquisition-date]_[MISR-Version]_[creation-date].txt</code>.</p></li>
<li><p>1 <code>IDL</code> <code>SAVE</code> file containing the numerical results of the correlation computations, named<br />
<code>corr_Pxxx_Oyyyyyy_Bzzz_L1B2_[misr_mode]_toabrf_</code><br />
<code>[acquisition-date]_[MISR-Version]_[creation-date].sav</code>.<br />
</p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output files may be inexistent, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 130: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 132: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 134: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 136: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 140: Input argument <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: Unrecognized <code>misr_mode</code> in a <code>CASE</code> statement.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 240: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>l1b2_folder</code>, <code>log_folder</code>, <code>save_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>find_l1b2gm_files.pro</code>.</p></li>
<li><p>Error 310: An exception condition occurred in function <code>find_l1b2lm_files.pro</code></p></li>
<li><p>Error 400: The directory <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The directory <code>save_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>cor_l1b2_block.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>cor_l1b2_block.pro</code></p></li>
<li><p><code>find_l1b2gm_files.pro</code></p></li>
<li><p><code>find_l1b2lm_files.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = cor_l1b2(&#39;GM&#39;, 168, 68050, 110, /LOG_IT, $
   /SAVE_IT, VERBOSE = 1, /DEBUG, EXCPT_COND = excpt_cond)

generates a log file and a save file in the default folder.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;03&#8211;15: Version 0.8 &#8212; Initial release under the name <code>cor_l1b2</code>.</p></li>
<li><p>2017&#8211;07&#8211;21: Version 0.9 &#8212; Use current version of the correlation routines; update documentation; change the function name to <code>cor_l1b2_gm.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;03&#8211;04: Version 1.1 &#8212; Update the function to rely on <code>get_l1b2_gm_files.pro</code> instead of <code>chk_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;02: Version 1.2 &#8212; Merge this function with its twin <code>cor_l1b2_lm.pro</code> and change the name to <code>cor_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;07&#8211;05: Version 1.6 &#8212; Update this routine to rely on the new function<br />
<code>get_host_info.pro</code> and the updated version of the function <code>set_root_dirs.pro</code>.</p></li>
<li><p>2019&#8211;01&#8211;24: Version 1.7 &#8212; Add the input keyword parameters <code>L1B2_FOLDER</code>,<br />
<code>L1B2_VERSION</code>, <code>LOG_IT</code>, <code>LOG_FOLDER</code>, <code>SAVE_IT</code>, <code>SAVE_FOLDER</code>, <code>VERBOSE</code>.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.11 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.12 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;12&#8211;19: Version 2.1.1 &#8212; Bug fix (missing <code>ENDIF</code> statement).</p></li>
</ul></li>
</ul>
<h2>cor_l1b2_block</h2>
<ul>
<li><p><strong>Purpose:</strong> This function computes the cross-correlation statistics between the 36 data channels contained in the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) files for the given <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> combination.</p></li>
<li><p><strong>Algorithm:</strong> This function computes the 630 <span class="math inline">(36&#8197;&#215;&#8197;35/2)</span> cross-correlations between the input data channels at the lowest available spatial resolution (1100 m for <span class="smallcaps">GM</span> and 275 m for <span class="smallcaps">LM</span>) and the results are saved in the output structure <code>stats_lr</code>. If the input arguments are for <span class="smallcaps">GM</span> data, this function (1) relies on the <code>IDL</code> function <code>hr2lr.pro</code> to downsize the 12 high spatial resolution data channels of the specified input files to match the lower spatial resolution of the remaining 24 data channels and (2) also computes the 66 <span class="math inline">(12&#8197;&#215;&#8197;11/2)</span> cross-correlations between the high spatial resolution data channels and those resuts are saved in the output structure <code>stats_hr</code>. If the input arguments are for <span class="smallcaps">LM</span> data, this latter structure is empty. All statistical results are carried out by the <code>IDL</code> function <code>cor_arrays.pro</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = cor_l1b2_block(l1b2_files, misr_mode, misr_path, $</code><br />
<code>misr_orbit, misr_block, stats_lr, stats_hr, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>l1b2_files {STRING array} [I]:</code> The file specifications (path and filename) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA GM radiance files.</p></li>
<li><p><code>misr_mode {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>.</p></li>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>stats_lr {STRUCTURE} [O]:</code> The cross-correlation statistics between all 36 <span class="smallcaps">MISR</span> BRF fields at low spatial resolution.</p></li>
<li><p><code>stats_hr {STRUCTURE} [O]:</code> The cross-correlation statistics between all 12 <span class="smallcaps">MISR</span> BRF fields at high spatial resolution.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>stats_lr</code> contains the correlation statistics for the 36 data channels at the lowest spatial resolution (1100 m for <span class="smallcaps">GM</span>, 275 m for <span class="smallcaps">LM</span>). For <span class="smallcaps">GM</span> input data, the output positional parameter <code>stats_hr</code> contains the correlation statistics for the 12 data channels available at the higher spatial resolution (275 m). In the case of <span class="smallcaps">LM</span> data, this second output structure is void.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>stats_lr</code> and <code>stats_hr</code> may be empty, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 130: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 132: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 134: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 136: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 140: Input argument <code>misr_block</code> is invalid.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 500: No or more than 1 file(s) found for first low resolution data channel (from 0 to 35).</p></li>
<li><p>Error 510: No or more than 1 file(s) found for second low resolution data channel (from <span class="math inline"><em>i</em>&#8197;+&#8197;1</span> to 35).</p></li>
<li><p>Error 520: An exception condition occurred in function <code>cor_arrays.pro</code> while computing correlations between the low resolution channels.</p></li>
<li><p>Error 530: No or more than 1 file(s) found for first high resolution data channel (from 0 to 12).</p></li>
<li><p>Error 540: No or more than 1 file(s) found for second high resolution data channel (from i+1 to 35).</p></li>
<li><p>Error 550: An exception condition occurred in function <code>cor_arrays.pro</code> while computing correlations between the high resolution channels.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading <code>l1b2_file_1</code> low resolution.</p></li>
<li><p>Error 620: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading <code>l1b2_file_2</code> low resolution.</p></li>
<li><p>Error 630: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading <code>l1b2_file_1</code> high resolution.</p></li>
<li><p>Error 640: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading <code>l1b2_file_2</code> high resolution.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_mode.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>cor_arrays.pro</code></p></li>
<li><p><code>hr2lr.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> If the input positional parameter <code>misr_mode</code> is set to <code>GM</code>, the correlation results are stored in two separate output structures: one (<code>stats_lr</code>) for the 36 low spatial resolution and one (<code>stats_hr</code>) for the 12 high spatial resolution data channels. If the input positional parameter <code>misr_mode</code> is set to <code>LM</code>, the correlation results are stored in the output structure <code>stats_hr</code> and the variable <code>stats_lr</code> is set to a null structure.</p></li>
<li><p><strong>Note 2:</strong> *** WARNING ***: Execution of this function can take a few minutes.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = cor_l1b2_block(l1b2_files, &#39;GM&#39;, 168, 68050, 110, stats_lr, $
   stats_hr, VERBOSE = 0, /DEBUG, EXCPT_COND = excpt_cond)

returns the statistical results in ouput arguments stats_lr and
stats_hr. Similarly

IDL&gt; rc = cor_l1b2_block(l1b2_files, &#39;LM&#39;, 168, 68050, 110, stats_lr, $
   stats_hr, VERBOSE = 0, /DEBUG, EXCPT_COND = excpt_cond)

returns the statistical results in ouput arguments stats_hr, while
stats_lr is an empty structure as there are no low spatial
resolution data in LM.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;02&#8211;28: Version 0.8 &#8212; Initial release under the name <code>cor_l1b2_block</code>.</p></li>
<li><p>2017&#8211;07&#8211;21: Version 0.9 &#8212; Removed code to write a log file (transferred to program <code>cor_l1b2.pro</code>, now called <code>cor_l1b2_gm.pro</code>); add <code>misr_path</code>, <code>misr_orbit</code>, <code>misr_block</code> and the <span class="smallcaps">MISR</span> data acquisition date to the output structures; update the documentation.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.1 &#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018&#8211;04&#8211;23: Version 1.2 &#8212; Improve the debugging tests.</p></li>
<li><p>2018&#8211;05&#8211;02: Version 1.3 &#8212; Merge this function with its twin<br />
<code>cor_l1b2_lm_block.pro</code> and change the name to <code>cor_l1b2_block.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;24: Version 1.6 &#8212; Add the input keyword parameter <code>VERBOSE</code>.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.11 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.12 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.1 &#8212; Update the code to use the current version of the function <code>hr2lr.pro</code>.</p></li>
</ul></li>
</ul>
<h2>count_l1b2gm_miss_poor</h2>
<ul>
<li><p><strong>Purpose:</strong> This function counts the number of bad (missing) and poor data values in all <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Radiance files available in the specified or default folder, and reports statistics by <span class="smallcaps">Orbit</span>, <span class="smallcaps">Camera</span> and <span class="smallcaps">Band</span>.</p></li>
<li><p><strong>Algorithm:</strong> This function retrieves the list of all available <span class="smallcaps">Orbits</span> in the specified or default folder, reads the Radiance and RDQI databuffers, and counts the number of pixel values equal to <code>65523</code> as bad and the number of RDQI values equal to <code>2B</code> as poor.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = count_l1b2gm_miss_poor(misr_path, misr_block, $</code><br />
<code>L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $</code><br />
<code>OUT_FOLDER = out_folder, VERBOSE = verbose, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_block {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2GM_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>OUT_FOLDER = out_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the output file(s).</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The results are contained in the output file, saved in the specified or default folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output file may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>l1b2gm_folder</code>, <code>out_folder</code> is not specified.</p></li>
<li><p>Error 300: The input folder <code>l1b2_fpath</code> is unreadable.</p></li>
<li><p>Error 310: The number of files in the folder containing <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files is not a multiple of 9.</p></li>
<li><p>Error 400: The output folder <code>out_fpath</code> (output file for bad values) is unwritable.</p></li>
<li><p>Error 410: The output folder <code>out_fpath</code> (output file for poor values) is unwritable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_MAKE_FILENAME</code>.</p></li>
<li><p>Error 620: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code>.</p></li>
<li><p>Error 630: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_dir.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> Because all available <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files need to be read, this function is very time consuming: it can take 20+ minutes to generate the statistics for a single <span class="smallcaps">Block</span> over the entire mission period.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_block = 110
IDL&gt; l1b2gm_folder = &#39;&#39;
IDL&gt; l1b2gm_version = &#39;&#39;
IDL&gt; out_folder = &#39;&#39;
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = count_l1b2gm_miss_poor(misr_path, misr_block, $
   L1B2GM_FOLDER = l1b2gm_folder, $
   L1B2GM_VERSION = l1b2gm_version, $
   OUT_FOLDER = out_folder, VERBOSE = verbose, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;04&#8211;20: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;04&#8211;21: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;04&#8211;25: Version 2.01 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.02 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;05&#8211;07: Version 2.03 &#8212; Update the code to generate a separate output file containing the statistics about poor values.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.04 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.05 &#8212; Rename this function <code>count_l1b2gm_miss_poor.pro</code>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>diag_l1b2_block_cam</h2>
<ul>
<li><p><strong>Purpose:</strong> This function reports statistics on the distribution of values found within the various fields of the various grids in a single <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> of a single, camera-specific, <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-projected Top of Atmosphere (ToA) Global Mode (GM) or Local Mode (LM) Radiance file. Specifically, for each defined field of each defined <code>HDF-EOS</code> grid within that file, hence in each of the 4 spectral bands, this function reports on</p>
<ul>
<li><p>the total number pixels in the <span class="smallcaps">Block</span>,</p></li>
<li><p>the number of valid pixels,</p></li>
<li><p>the numbers of fill values of different types,</p></li>
<li><p>the minimum and maximum values of the 2 radiance fields (scaled and unscaled) as well as of the reflectance field.</p></li>
</ul>
<p>If the optional keyword parameter <code>HIST_IT</code> is set, this function also generates histograms of the ToA <code>BRF</code> values found in each spectral data channel and saves them in the default or specified output folder.</p></li>
<li><p><strong>Algorithm:</strong> This function scans the designated <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Global Mode (GM) or Local Mode (LM) Radiance file and tallies the various types of pixel values with the <code>WHERE</code>, <code>MIN</code> and <code>MAX</code> functions.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = diag_l1b2_block_cam(l1b2_file, misr_block, meta_data, $</code><br />
<code>HIST_IT = hist_it, HIST_FOLDER = hist_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>l1b2_file {STRING} [I]:</code> The full specification (path and filename) of a <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA GM or LM radiance file (i.e., for a single camera).</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number to be inspected within that file.</p></li>
<li><p><code>meta_data {STRUCTURE} [O]:</code> Metadata about the valid or fill radiance data values contained in the selected <span class="smallcaps">Block</span>, for each of the 4 spectral bands.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>HIST_IT = hist_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating histograms of the numerical results.</p></li>
<li><p><code>HIST_FOLDER = hist_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the histograms.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>meta_data</code> contains a structure with the desired information. If the optional input keyword parameter <code>HIST_IT</code> is set in the call, this function will generate 4 histograms of the <code>BRF</code> values found in the data channels for the current camera. These histograms are named<br />
<code>Hist_L1B2_diag_ + [mpob_str] + &#8217;-&#8217; + [misr_camera] + &#8217;-&#8217; + $</code><br />
<code>[misr_band] + &#8217;_&#8217; + [acquis_date] + &#8217;_&#8217; + [date] + &#8217;.png&#8217;</code> and located in the default or specified folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The structure <code>meta_data</code> is not created and the histograms are not saved.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input positional parameter <code>l1b2_file</code> is not found, not a regular file or not readable.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in <code>orbit2date.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in <code>path2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in <code>orbit2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in <code>block2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameter <code>hist_folder</code> is not specified.</p></li>
<li><p>Error 400: The output folder <code>hist_fpath</code> is unwritable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_TO_GRIDLIST</code>.</p></li>
<li><p>Error 620: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_GRID_TO_FIELDLIST</code>.</p></li>
<li><p>Error 630: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code>.</p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> If the optional input keyword parameter <code>hist_it</code> is set, this function generates 4 histograms, 1 for each spectral data channel of the <span class="smallcaps">L1B2</span> <span class="smallcaps">GRP</span> ToA radiance input file.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>See the documentation for the functions
   diag_l1b2gm.pro and diag_l1b2lm.pro.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;12: Version 0.8 &#8212; Initial release under the name <code>diag_l1b2_block</code>.</p></li>
<li><p>2017&#8211;10&#8211;10: Version 0.9 &#8212; Changed the name of the function to<br />
<code>diag_l1b2_gm_block.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.1 &#8212; Merge this function with its twin<br />
<code>diag_l1b2_lm_block.pro</code> and change the name back to <code>diag_l1b2_block.pro</code>.</p></li>
<li><p>2018&#8211;06&#8211;07: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;07&#8211;07: Version 1.6 &#8212; Update this routine to report on the location of pixels with an <code>RDQI</code> value of 2.</p></li>
<li><p>2018&#8211;11&#8211;30: Version 1.7 &#8212; Change the name of the function to<br />
<code>diag_l1b2_block_cam</code> for consistency, update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.11 &#8212; Add code to set the <code>BUFFER</code> keyword parameter as a function of the <code>VERBOSE</code> keyword parameter.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.12 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.13 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;10&#8211;24: Version 2.1.1 &#8212; Update the code to save the histograms in a folder consistent with the rest of the <span class="smallcaps">L1B2</span> processing routines.</p></li>
</ul></li>
</ul>
<h2>diag_l1b2gm</h2>
<ul>
<li><p><strong>Purpose:</strong> This function collects metadata and basic statistics about the contents of a single <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> within each of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Global Mode (GM) Radiance files for the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, and <span class="smallcaps">Block</span>, and saves these results into 9 text files and 9 corresponding <code>IDL</code> <code>SAVE</code> files. If the input keyword parameter <code>hist_it</code> is set, this function generates histograms of the ToA <code>BRF</code> values found in each spectral data channel and saves them in the output folder specified by the keyword <code>hist_folder</code>, if provided, or the default otherwise.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the function <code>diag_l1b2_block_cam</code> to retrieve the desired information about each camera file for the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, and <span class="smallcaps">Block</span>, and saves the 18 <code>.txt</code> and <code>.sav</code> output files.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = diag_l1b2gm(misr_path, misr_orbit, misr_block, $</code><br />
<code>L1B2GM_FOLDER = l1b2gm_folder, L1B2_VERSION = l1b2gm_version, $</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder, $</code><br />
<code>HIST_IT = hist_it, HIST_FOLDER = hist_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>HIST_IT = hist_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating histograms of the numerical results.</p></li>
<li><p><code>HIST_FOLDER = hist_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the histograms.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. This function saves 18 output files in the folder<br />
<code>root_dirs[2] + &#8217;/Pxxx_Oyyyyyy_Bzzz/L1B2_[misr_mode]/&#8217;</code>:</p>
<ul>
<li><p>9 plain text output files containing diagnostic information for each camera, named<br />
<code>diag_Pxxx_Oyyyyyy_Bzzz_L1B2_[misr_mode]_[camera_name]_</code><br />
<code>[YYYY-MM-DD]_[MISR-Version]_[creation-date].txt</code>.</p></li>
<li><p>9 <code>IDL</code> <code>SAVE</code> output files containing diagnostic information for each camera, named<br />
<code>diag_Pxxx_Oyyyyyy_Bzzz_L1B2_[misr_mode]_[camera_name]_</code><br />
<code>[YYYY-MM-DD]_[MISR-Version]_[creation-date].sav</code>.</p></li>
</ul>
<p>In addition, if the optional input keyword parameter <code>HISTOGRAMS</code> is set in the call, the function <code>diag_l1b2_block_cam.pro</code> called by this routine will also generate</p>
<ul>
<li><p>36 histograms of the ToA <code>BRF</code> values found in these data channels, named<br />
<code>Hist_L1B2_diag_ + [mpob_str] + &#8217;-&#8217; + [misr_camera] + &#8217;-&#8217; + $</code><br />
<code>[misr_band] + &#8217;_&#8217; + [acquis_date] + &#8217;_&#8217; + [date] + &#8217;.png&#8217;</code></p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output files may be inexistent, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 126: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 130: Input argument <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>l1b2gm_folder</code>, <code>log_folder</code>, <code>save_folder</code>, <code>hist_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>find_l1b2gm_files</code>.</p></li>
<li><p>Error 400: The directory <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The directory <code>save_fpath</code> is unwritable.</p></li>
<li><p>Error 420: The directory <code>hist_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>diag_l1b2_block_cam.pro</code>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_VERSION</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>diag_l1b2_block_cam.pro</code></p></li>
<li><p><code>find_l1b2gm_files.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>oom.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The input keyword parameters <code>log_it</code>, <code>save_it</code>, and <code>hist_it</code> are provided to generate the desired outputs selectively. Deselecting some of them (<code>hist_it</code> in particular) may accelerate the processing, but if none of them are set, then no output will be saved either.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = diag_l1b2gm(168, 68050, 110, $
   /LOG_IT, /SAVE_IT, /HIST_IT, $
   /VERBOSE, /DEBUG, EXCPT_COND = excpt_cond)

results in the creation of 9 plain text files, 9 .sav files and
36 histograms in the folder root_dirs[3] + &#39;P168-O068050-B110/GM/&#39;.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;14: Version 0.8 &#8212; Initial release under the name <code>diag_l1b2.pro</code>.</p></li>
<li><p>2017&#8211;10&#8211;10: Version 0.9 &#8212; Changed the name of the function to <code>diag_l1b2_gm.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;03&#8211;04: Version 1.1 &#8212; Update the function to rely on <code>get_l1b2_gm_files.pro</code> instead of <code>chk_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.2 &#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.3 &#8212; Merge this function with its twin <code>diag_l1b2_lm.pro</code> and change the name back to <code>diag_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;06&#8211;07: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;06&#8211;17: Version 1.6 &#8212; Add <span class="smallcaps">MISR</span> version number in the names of the output files.</p></li>
<li><p>2018&#8211;07&#8211;07: Version 1.7 &#8212; Update this routine to rely on the new function<br />
<code>get_host_info.pro</code> and the updated version of the function <code>set_root_dirs.pro</code>; and to take advantage of the updated version of function <code>diag_l1b2_block_cam.pro</code>.</p></li>
<li><p>2019&#8211;01&#8211;23: Version 1.8 &#8212; Add the input keyword parameters <code>L1B2_FOLDER</code> and <code>L1B2_VERSION</code>, <code>LOG_IT</code> and <code>LOG_FOLDER</code>, <code>SAVE_IT</code> and <code>SAVE_FOLDER</code>, <code>HIST_IT</code> and <code>HIST_FOLDER</code></p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.11 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.13 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.14 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.15 &#8212; Make this function specific to <span class="smallcaps">GM</span> input files.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>diag_l1b2lm</h2>
<ul>
<li><p><strong>Purpose:</strong> This function collects metadata and basic statistics about the contents of a single <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> within each of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance files of the specified Local Mode (LM) site, <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, and <span class="smallcaps">Block</span>, and saves these results into 9 text files and 9 corresponding <code>IDL</code> <code>SAVE</code> files. If the input keyword parameter <code>hist_it</code> is set, this function generates histograms of the ToA <code>BRF</code> values found in each spectral data channel and saves them in the output folder specified by the keyword <code>hist_folder</code>, if provided, or the default otherwise.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the function <code>diag_l1b2_block_cam</code> to retrieve the desired information about each camera file for the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, and <span class="smallcaps">Block</span>, and saves the 18 <code>.txt</code> and <code>.sav</code> output files.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = diag_l1b2lm(misr_site, misr_path, misr_orbit, misr_block, $</code><br />
<code>L1B2LM_FOLDER = l1b2lm_folder, L1B2LM_VERSION = l1b2lm_version, $</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder, $</code><br />
<code>HIST_IT = hist_it, HIST_FOLDER = hist_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_site {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> LM Site.</p></li>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2LM_FOLDER = l1b2lm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2LM_VERSION = l1b2lm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>HIST_IT = hist_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating histograms of the numerical results.</p></li>
<li><p><code>HIST_FOLDER = hist_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the histograms.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. This function saves 18 output files in the folder<br />
<code>root_dirs[2] + &#8217;/Pxxx_Oyyyyyy_Bzzz/L1B2_[misr_mode]/&#8217;</code>:</p>
<ul>
<li><p>9 plain text output files containing diagnostic information for each camera, named<br />
<code>diag_Pxxx_Oyyyyyy_Bzzz_L1B2_[misr_mode]_[camera_name]_</code><br />
<code>[YYYY-MM-DD]_[MISR-Version]_[creation-date].txt</code>.</p></li>
<li><p>9 <code>IDL</code> <code>SAVE</code> output files containing diagnostic information for each camera, named<br />
<code>diag_Pxxx_Oyyyyyy_Bzzz_L1B2_[misr_mode]_[camera_name]_</code><br />
<code>[YYYY-MM-DD]_[MISR-Version]_[creation-date].sav</code>.</p></li>
</ul>
<p>In addition, if the optional input keyword parameter <code>HISTOGRAMS</code> is set in the call, the function <code>diag_l1b2_block_cam.pro</code> called by this routine will also generate</p>
<ul>
<li><p>36 histograms of the ToA <code>BRF</code> values found in these data channels, named<br />
<code>Hist_L1B2_diag_ + [mpob_str] + &#8217;-&#8217; + [misr_camera] + &#8217;-&#8217; + $</code><br />
<code>[misr_band] + &#8217;_&#8217; + [acquis_date] + &#8217;_&#8217; + [date] + &#8217;.png&#8217;</code></p></li>
</ul></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output files may be inexistent, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 126: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 130: Input argument <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>l1b2gm_folder</code>, <code>log_folder</code>, <code>save_folder</code>, <code>hist_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>find_l1b2lm_files</code>.</p></li>
<li><p>Error 400: The directory <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The directory <code>save_fpath</code> is unwritable.</p></li>
<li><p>Error 420: The directory <code>hist_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>diag_l1b2_block_cam.pro</code>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_FILE_VERSION</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>diag_l1b2_block_cam.pro</code></p></li>
<li><p><code>find_l1b2lm_files.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>oom.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The input keyword parameters <code>log_it</code>, <code>save_it</code>, and <code>hist_it</code> are provided to generate the desired outputs selectively. Deselecting some of them (<code>hist_it</code> in particular) may accelerate the processing, but if none of them are set, then no output will be saved either.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; rc = diag_l1b2lm(&#39;Skukuza&#39;, 168, 68050, 110, $
   /LOG_IT, /SAVE_IT, /HIST_IT, $
   /VERBOSE, /DEBUG, EXCPT_COND = excpt_cond)

results in the creation of 9 plain text files, 9 .sav files and
36 histograms in the folder root_dirs[3] + &#39;P168-O068050-B110/LM/&#39;.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;14: Version 0.8 &#8212; Initial release under the name <code>diag_l1b2.pro</code>.</p></li>
<li><p>2017&#8211;10&#8211;10: Version 0.9 &#8212; Changed the name of the function to <code>diag_l1b2_gm.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;03&#8211;04: Version 1.1 &#8212; Update the function to rely on <code>get_l1b2_gm_files.pro</code> instead of <code>chk_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.2 &#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.3 &#8212; Merge this function with its twin <code>diag_l1b2_lm.pro</code> and change the name back to <code>diag_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;06&#8211;07: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;06&#8211;17: Version 1.6 &#8212; Add <span class="smallcaps">MISR</span> version number in the names of the output files.</p></li>
<li><p>2018&#8211;07&#8211;07: Version 1.7 &#8212; Update this routine to rely on the new function<br />
<code>get_host_info.pro</code> and the updated version of the function <code>set_root_dirs.pro</code>; and to take advantage of the updated version of function <code>diag_l1b2_block_cam.pro</code>.</p></li>
<li><p>2019&#8211;01&#8211;23: Version 1.8 &#8212; Add the input keyword parameters <code>L1B2_FOLDER</code> and <code>L1B2_VERSION</code>, <code>LOG_IT</code> and <code>LOG_FOLDER</code>, <code>SAVE_IT</code> and <code>SAVE_FOLDER</code>, <code>HIST_IT</code> and <code>HIST_FOLDER</code></p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.11 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.13 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.14 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.15 &#8212; Create this function using the most current version of <code>diag_l1b2.pro</code> as a template, add the <code>misr_site</code> input argument.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>doc_l1b2</h2>
<p>l1b2gm_files</p>
<ul>
<li><p><strong>Purpose:</strong> This program generates histograms and maps of the data contained in the standard <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance files corresponding to the specified input positional parameters <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>.</p></li>
<li><p><strong>Algorithm:</strong> This program calls the functions <code>diag_l1b2.pro</code>, <code>map_l1b2_block.pro</code> and <code>map_l1b2_miss.pro</code> to generate the histograms and maps of the standard <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance files corresponding to the specified input positional parameters <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span>. and <span class="smallcaps">Block</span>.</p></li>
<li><p><strong>Syntax:</strong> <code>doc_l1b2, misr_mode, misr_path, misr_orbit, misr_block, $</code><br />
<code>L1B2_FOLDER = l1b2_folder, L1B2_VERSION = l1b2_version, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder, $</code><br />
<code>HIST_IT = hist_it, HIST_FOLDER = hist_folder, $</code><br />
<code>MAP_IT = map_it, MAP_FOLDER = map_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>.</p></li>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>HIST_IT = hist_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating histograms of the numerical results.</p></li>
<li><p><code>HIST_FOLDER = hist_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the histograms.</p></li>
<li><p><code>MAP_IT = map_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the numerical results.</p></li>
<li><p><code>MAP_FOLDER = map_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the maps.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> N/A.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, the keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The number of output files generated depends on the settings of the optional input keyword parameters <code>log_it</code>, <code>save_it</code>, <code>hist_it</code> and <code>map_it</code>. Customized outputs can be generated by calling those functions <code>diag_l1b2.pro</code>, <code>map_l1b2_block.pro</code> and <code>map_l1b2_miss.pro</code> individually. See the documentation of these functions for further details.</p></li>
<li><p>If an exception condition has been detected, the optional output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. This program prints an error message and returns control to the calling program or to the console; the expected output files may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 130: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 132: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 134: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 136: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 140: Input argument <code>misr_block</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 230: An exception condition occurred in function <code>heap_l1b2_block.pro</code>.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>heap_l1b2_block</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_mode.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>diag_l1b2.pro</code></p></li>
<li><p><code>first_char.pro</code></p></li>
<li><p><code>heap_l1b2_block.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>map_l1b2.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This program calls the mapping functions with the default scaling options. To generate maps with other settings, call those functions individually.</p></li>
<li><p><strong>Note 2:</strong> This program also reports on the time spent on each of the main routines it calls to generate the desired outcomes.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; doc_l1b2, &#39;GM&#39;, 168, 68050, 110, $
   /LOG_IT, /SAVE_IT, /HIST_IT, /MAP_IT, $
   VERBOSE = 0, /DEBUG, EXCPT_COND = excpt_cond

results in the creation of all output files generated by the functions
diag_l1b2, map_l1b2_block and map_l1b2_miss.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;24: Version 0.8 &#8212; Initial release under the name <code>doc_l1b2</code>.</p></li>
<li><p>2017&#8211;10&#8211;10: Version 0.9 &#8212; Renamed the function to <code>doc_l1b2_gm.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;04&#8211;20: Version 1.1 &#8212; Update the documentation to refer to<br />
<code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018&#8211;06&#8211;01: Version 1.2 &#8212; Merge this function with its twin <code>doc_l1b2_lm.pro</code> and change the name to <code>doc_l1b2_block.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2019&#8211;01&#8211;24: Version 1.6 &#8212; Update the code to call the new versions of other routines.</p></li>
<li><p>2019&#8211;02&#8211;17: Version 1.7 &#8212; Simplify this program to focus exclusively on documenting the standard <span class="smallcaps">MISR</span> L1B2 data through histograms and maps.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;11: Version 2.11 &#8212; Bug fix: Corrected return statements; use the function <code>map_l1b2.pro</code> rather than the deprecated functions <code>map_l1b2_block.pro</code> and <code>map_l1b2_miss.pro</code>.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.12 &#8212; Bug fix: Update <code>RETURN</code> statement after the call to <code>heap_l1b2_block</code> and update the handling of responses to run-time questions.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.13 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;12&#8211;19: Version 2.1.1 &#8212; Bug fix (replace <code>RETURN</code> by <code>STOP</code> statements) and code update to call the current versions of <code>diag_l1b2gm.pro</code> and <code>diag_l1b2lm.pro</code>, and to set the value of <code>prefix</code> before calling <code>map_l1b2.pro</code>.</p></li>
</ul></li>
</ul>
<h2>find_l1b2gm_files</h2>
<ul>
<li><p><strong>Purpose:</strong> This function provides the file specifications of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Global Mode radiance files corresponding to the specified <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>, if they are available in the expected folder. These file specifications are provided in their native order: <code>DF</code>, <code>CF</code>, &#8230;, <code>AN</code>, &#8230;, <code>CA</code>, <code>DA</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function reports the file specifications (path + names) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Global Mode Radiance files for the specified <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span> in the default or specified folder, for the default or specified version, and verifies that they are readable.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = find_l1b2gm_files(misr_path, misr_orbit, $</code><br />
<code>l1b2gm_files, L1B2GM_FOLDER = l1b2gm_folder, $</code><br />
<code>L1B2GM_VERSION = l1b2gm_version, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>l1b2gm_files {STRING array} [O]:</code> The file specifications (path and filenames) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP GM ToA radiance files for the specified <code>misr_path</code> and <code>misr_orbit</code>, in the native order <code>DF</code> to <code>DA</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2GM_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>l1b2gm_files</code> contains the specifications of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA radiance files for the specified <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided. The output positional parameter <code>l1b2gm_files</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 126: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 202: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 212: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameter <code>l1b2gm_folder</code> is not specified.</p></li>
<li><p>Error 300: The input folder <code>l1b2gm_fpath</code> is not a directory or not readable.</p></li>
<li><p>Error 310: The input folder <code>l1b2gm_fpath</code> does not contain any <span class="smallcaps">L1B2</span> <span class="smallcaps">GM</span> files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 320: The input folder <code>l1b2gm_fpath</code> contains multiple <span class="smallcaps">L1B2</span> <span class="smallcaps">GM</span> files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 330: At least one of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP GM ToA radiance files <code>l1b2gm_files[cam]</code> in the input folder <code>l1b2gm_fpath</code> is not readable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_MAKE_FILENAME</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_dir.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> If specified, the optional keyword parameter <code>L1B2GM_FOLDER</code> overrides the default address set in <code>set_roots_vers.pro</code>.</p></li>
<li><p><strong>Note 2:</strong> If specified, the optional keyword parameter <code>L1B2GM_VERSION</code> overrides the default version identifier set in <code>set_roots_vers.pro</code>.</p></li>
<li><p><strong>Note 3:</strong> This function assumes that the folder <code>l1b2gm_fpath</code>, defined either by default or by the input keyword parameter <code>l1b2gm_folder</code>, contains full <span class="smallcaps">Orbit</span>s, i.e., that files contain data for all <span class="smallcaps">Block</span>s. Exception condition <code>420</code> may be triggered if more than 9 files are identified for the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>, as may be the case if the folder contains subsetted <span class="smallcaps">L1B2</span> files.</p></li>
<li><p><strong>Note 4:</strong> All 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA radiance files for the given <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span> are expected to reside in the same folder.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; rc = find_l1b2gm_files(misr_path, misr_orbit, $
   l1b2gm_files, /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + &#39; and excpt_cond = &gt;&#39; + $
   excpt_cond + &#39;&lt;&#39;
rc = 0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, FILE_DIRNAME(l1b2gm_files[0], /MARK_DIRECTORY)
/Volumes/MISR_Data3/P168/L1_GM/
IDL&gt; PRINT, FILE_BASENAME(l1b2gm_files)
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_AA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_AF_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_AN_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_BA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_BF_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_CA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_CF_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_DA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_GM_P168_O068050_DF_F03_0024.hdf</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;16: Version 0.8 &#8212; Initial release under the name <code>chk_l1b2gm_files</code>.</p></li>
<li><p>2017&#8211;10&#8211;10: Version 0.9 &#8212; Changed the function name to <code>chk_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;03&#8211;04: Version 1.1 &#8212; Changed the function name to <code>get_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.2 &#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;04: Version 1.3 &#8212; Merge this function with its twin<br />
<code>get_l1b2_lm_files.pro</code> and change the name to <code>get_l1b2gm_files.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;12&#8211;25: Version 1.6 &#8212; Rename this function to <code>find_l1b2gm_files.pro</code> and update the documentation.</p></li>
<li><p>2019&#8211;02&#8211;21: Version 1.7 &#8212; Update this function to return the file specifications in the native order of <span class="smallcaps">MISR</span> cameras.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.11 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.12 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>find_l1b2lm_files</h2>
<ul>
<li><p><strong>Purpose:</strong> This function provides the file specifications of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Local Mode radiance files corresponding to the specified <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>, if they are available in the expected folder. These file specifications are provided in their native order: <code>DF</code>, <code>CF</code>, &#8230;, <code>AN</code>, &#8230;, <code>CA</code>, <code>DA</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function reports the file specifications (path + names) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Global Mode Radiance files for the specified <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span> in the default or specified folder, for the default or specified version, and verifies that they are readable.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = find_l1b2lm_files(misr_site, misr_path, misr_orbit, $</code><br />
<code>l1b2lm_files, L1B2LM_FOLDER = l1b2lm_folder, $</code><br />
<code>L1B2LM_VERSION = l1b2lm_version, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_site{STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> Site name.</p></li>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>l1b2lm_files {STRING array} [O]:</code> The file specifications (path and filenames) of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP LM ToA radiance files for the specified <code>misr_site</code>, <code>misr_path</code> and <code>misr_orbit</code>, in the native order <code>DF</code> to <code>DA</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2LM_FOLDER = l1b2lm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2LM_VERSION = l1b2lm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output positional parameter <code>l1b2lm_files</code> contains the specifications of the 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA radiance files for the specified <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided. The output positional parameter <code>l1b2lm_files</code> may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 122: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 124: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 126: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 202: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 212: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameter <code>l1b2lm_folder</code> is not specified.</p></li>
<li><p>Error 300: The input folder <code>l1b2lm_fpath</code> is not a directory or not readable.</p></li>
<li><p>Error 310: The input folder <code>l1b2lm_fpath</code> does not contain any <span class="smallcaps">L1B2</span> <span class="smallcaps">LM</span> files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 320: The input folder <code>l1b2lm_fpath</code> contains multiple <span class="smallcaps">L1B2</span> <span class="smallcaps">LM</span> files for selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span>.</p></li>
<li><p>Error 330: At least one of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP LM ToA radiance files <code>l1b2lm_files[cam]</code> in the input folder <code>l1b2lm_fpath</code> is not readable.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_MAKE_FILENAME</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_dir.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_cap.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> If specified, the optional keyword parameter <code>L1B2LM_FOLDER</code> overrides the default address set in <code>set_roots_vers.pro</code>.</p></li>
<li><p><strong>Note 2:</strong> If specified, the optional keyword parameter <code>L1B2LM_VERSION</code> overrides the default version identifier set in <code>set_roots_vers.pro</code>.</p></li>
<li><p><strong>Note 3:</strong> This function assumes that the folder <code>l1b2lm_fpath</code>, defined either by default or by the input keyword parameter <code>l1b2lm_folder</code>, contains all 9 <span class="smallcaps">L1B2</span> LM files for the specified <code>misr_site</code>.</p></li>
<li><p><strong>Note 4:</strong> All 9 <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA radiance files for the given <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span> are expected to reside in the same folder.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_site = &#39;Skukuza&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; rc = find_l1b2lm_files(misr_site, misr_path, $
   misr_orbit, l1b2lm_files, /VERBOSE, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, FILE_DIRNAME(l1b2lm_files[0], /MARK_DIRECTORY)
/Volumes/MISR_Data0/P168/L1_LM/
IDL&gt; PRINT, FILE_BASENAME(l1b2lm_files)
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_DF_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_CF_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_BF_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_AF_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_AN_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_AA_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_BA_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_CA_SITE_SKUKUZA_F03_0024.hdf
MISR_AM1_GRP_TERRAIN_LM_P168_O068050_DA_SITE_SKUKUZA_F03_0024.hdf</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;07&#8211;16: Version 0.8 &#8212; Initial release under the name <code>chk_l1b2gm_files</code>.</p></li>
<li><p>2017&#8211;10&#8211;10: Version 0.9 &#8212; Changed the function name to <code>chk_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;03&#8211;04: Version 1.1 &#8212; Changed the function name to <code>get_l1b2_gm_files.pro</code>.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.2 &#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;04: Version 1.3 &#8212; Merge this function with its twin<br />
<code>get_l1b2_lm_files.pro</code> and change the name to <code>get_l1b2gm_files.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;12&#8211;25: Version 1.6 &#8212; Rename this function to <code>find_l1b2gm_files.pro</code> and update the documentation.</p></li>
<li><p>2019&#8211;02&#8211;21: Version 1.7 &#8212; Update this function to return the file specifications in the native order of <span class="smallcaps">MISR</span> cameras.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.11 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.12 &#8212; Create this function using <code>find_l1b2gm_files.pro</code> as a template.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>find_miss_l1b2gm_files</h2>
<ul>
<li><p><strong>Purpose:</strong> This function inspects the available <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Global Mode files for the specified <span class="smallcaps">Path</span>, and reports on missing files within the specified or default period.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <span class="smallcaps">MISR</span> Toolkit to generate a list of <span class="smallcaps">L1B2</span> <span class="smallcaps">GM</span> files for the specified <span class="smallcaps">Path</span> and the default (or optionally specified <span class="smallcaps">Version</span>) that occur between the <code>from_date</code> and the <code>until_date</code> dates, inclusive. It checks whether these files exist and are readable in the default or specified location, and reports on the number of missing files. If the optional input keyword parameter <code>log_it</code> is set, it saves a log file containing the names of the missing files, in the default or specified folder.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = find_miss_l1b2gm_files(misr_path, n_miss_l1b2gm_files, $</code><br />
<code>FROM_DATE = from_date, UNTIL_DATE = until_date, n_miss_l1b2gm_files $</code><br />
<code>L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>n_miss_l1b2gm_files {LONG} [O]:</code> The number of missing <span class="smallcaps">MISR</span> Global Mode L1B2 files.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2GM_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>n_miss_l1b2gm_files</code> reports on the number of missing files in the designated or default folder, between the specified dates. A log file is saved if the input keyword parameter <code>LOG_IT</code> is set.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>n_miss_l1b2gm_files</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>chk_ymddate.pro</code>.</p></li>
<li><p>Error 220: An exception condition occurred in function <code>chk_ymddate.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>l1b2gm_folder</code>, <code>log_folder</code> is not specified.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>set_l1b2gm_folder.pro</code>.</p></li>
<li><p>Error 400: The output folder <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>find_orbits_paths_dates.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>chk_ymddate.pro</code></p></li>
<li><p><code>find_orbits_paths_dates.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_l1b2gm_folder.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function <strong>only</strong> works for <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Global Mode data, because Local Mode acquisitions are generally temporary and result in files with different, non-standard filenames.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; from_date = &#39;2000-02-24&#39;
IDL&gt; until_date = &#39;2018-12-31&#39;
IDL&gt; l1b2gm_folder = &#39;&#39;
IDL&gt; l1b2gm_version = &#39;&#39;
IDL&gt; log_it = 1
IDL&gt; log_folder = &#39;&#39;
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = find_miss_l1b2gm_files(misr_path, $
   n_miss_l1b2gm_files, FROM_DATE = from_date, $
   UNTIL_DATE = until_date, $
   L1B2GM_FOLDER = l1b2gm_folder, $
   L1B2GM_VERSION = l1b2gm_version, $
   LOG_IT = log_it, LOG_FOLDER = log_folder, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)

The log file has been saved in ~/MISR_HR/Outcomes/P168/GM/Missing_L1B2GM_Orbits_2019-10-27.txt.
Number of missing files for Path 168 between
   2000-02-24T00:00:00Z and 2018-12-31T23:59:59Z is 63.</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;10: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;05&#8211;12: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.01 &#8212; Update the code to rely on the <code>IDL</code> function <code>FILE_TEST</code> rather than <code>is_writable</code>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>VERBOSE</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;10&#8211;26: Version 2.1.1 &#8212; Improve the screen output when <code>VERBOSE</code> is set.</p></li>
</ul></li>
</ul>
<h2>fix_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function replaces missing and optionally poor values in the <span class="smallcaps">L1B2</span> data buffers specified by the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> by estimates based on the best linear fit equation with another concurrent highly correlated data channel.</p></li>
<li><p><strong>Algorithm:</strong> This function inspects and updates the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data for the specified <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> accessible through pointers to heap variables, defines the clear land, clear water and cloud masks (themselves corrected for missing values), computes the best linear fit relations between the target <span class="smallcaps">L1B2</span> radiance data channels that contain missing values and the other 35 available source data channels for the same <span class="smallcaps">Block</span>, replaces the bad and optionally poor data by the new estimates, optionally maps initial and final products, and makes the fixed data buffers accessible through new pointers (to heap variables) after optionally saving all variables in an IDL save file.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = fix_l1b2(misr_ptr, radrd_ptr, rad_ptr, brf_ptr,$</code><br />
<code>rdqi_ptr, scalf_ptr, convf_ptr, fixed_misr_ptr, fixed_radrd_ptr,$</code><br />
<code>fixed_rad_ptr, fixed_brf_ptr, fixed_rdqi_ptr, $</code><br />
<code>AGP_FOLDER = agp_folder, AGP_VERSION = agp_version, $</code><br />
<code>L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version,$</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version,$</code><br />
<code>N_MASKS = n_masks, ALSO_POOR = also_poor, N_ATTEMPTS = n_attempts,$</code><br />
<code>TEST_ID = test_id, FIRST_LINE = first_line, LAST_LINE = last_line,$</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder,$</code><br />
<code>SAVE_IT = save_it, SAVE_FOLDER = save_folder,$</code><br />
<code>SCATT_IT = scatt_it, SCATT_FOLDER = scatt_folder,$</code><br />
<code>SET_MIN_SCATT = set_min_scatt, SET_MAX_SCATT = set_max_scatt,$</code><br />
<code>MAP_IT = map_it, MAP_FOLDER = map_folder,$</code><br />
<code>MAP_BRF = map_brf, MAP_QUAL = map_qual,$</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 4 pointer arrays.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>rad_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> unscaled radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>brf_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [O]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>scalf_ptr {POINTER array} [O]:</code> The array of 36 <code>DOUBLE</code> scale factors used to convert the unsigned 14-bit integer data into radiance measurements, in units of W m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;2</sup></span> sr<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span> <span class="math inline"><em>&#956;</em></span>m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span>.</p></li>
<li><p><code>convf_ptr {POINTER array} [O]:</code> The array of 36 pointers to the data buffers containing the <code>FLOAT</code> conversion factor arrays to convert radiances into bidirectional reflectance factors.</p></li>
<li><p><code>fixed_misr_ptr {POINTER} [O]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 3 pointer arrays.</p></li>
<li><p><code>fixed_radrd_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>fixed_radrd_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> unscaled radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>fixed_brf_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>fixed_rdqi_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>AGP_FOLDER = agp_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">AGP</span> files, if they are not located in the default location.</p></li>
<li><p><code>AGP_VERSION = agp_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">AGP</span> version identifier to use instead of the default value.</p></li>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GM files, if they are not located in the default location.</p></li>
<li><p><code>L1B2GM_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> GM version identifier to use instead of the default value.</p></li>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>N_MASKS = n_masks {INT} [I] (Default value: 3):</code> The number of target types that need to be discriminated by the masks: <code>1</code> to generate a single mask for all geophysical target types, <code>2</code> to generate masks separately for land masses and water bodies, or <code>3</code> to generate masks separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><code>ALSO_POOR = also_poor {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) replacing poor <span class="smallcaps">L1B2</span> values (i.e., those with RDQI = <code>2B</code>) by new estimates.</p></li>
<li><p><code>N_ATTEMPTS = n_attempts {INT} [I] (Default value: 1):</code> Flag to indicate the maximum number of &#8216;best&#8217; linear fit equations can be considered when trying to replace bad (missing) or optionally poor <span class="smallcaps">L1B2</span> values.</p></li>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> String to designate a particular experiment (e.g., to test the performance of the algorithm), used in the filenames of the log, map and scatterplot files.</p></li>
<li><p><code>FIRST_LINE = first_line {INT array of 36 elements} [I] (Default value: 36 elements set to -1):</code> The index (between 0 and 127 [for GM data] or 511 [for LM data]) of the first line to be replaced by missing data, in the corresponding cameras and spectral bands. Values outside that range are ignored.</p></li>
<li><p><code>LAST_LINE = last_line {INT array of 36 elements} [I] (Default value: 36 elements set to -1):</code> The index (between 0 and 127 [for GM data] or 511 [for LM data]) of the last line to be replaced by missing data, in the corresponding cameras and spectral bands. Values outside that range are ignored.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>SAVE_IT = save_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) saving the results in a savefile.</p></li>
<li><p><code>SAVE_FOLDER = save_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the savefile.</p></li>
<li><p><code>SCATT_IT = scatt_it {INT} [I] (Default value: 0):</code> Flag to generate (1) or skip (0) a scatterplot of the two best correlated data channels for each of the cases specified by <code>n_masks</code>.</p></li>
<li><p><code>SCATT_FOLDER = scatt_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the scatterplots.</p></li>
<li><p><code>SET_MIN_SCATT = set_min_scatt {STRING} [I] (Default value: None):</code> The minimum value to be used on the <code>X</code> and <code>Y</code> axes of the scatterplots. WARNING: This value must be provided as a <code>STRING</code> because the value <code>0.0</code> is frequently desirable as the minimum for the scatterplot, but that numerical value would be misinterpreted as NOT setting the keyword.</p></li>
<li><p><code>SET_MAX_SCATT = set_max_scatt {STRING} [I] (Default value: None):</code> The maximum value to be used on the <code>X</code> and <code>Y</code> axes of the scatterplots. WARNING: By analogy with <code>set_min_scatt</code>, this value must be provided as a <code>STRING</code>.</p></li>
<li><p><code>MAP_IT = map_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the clear land, clear water and cloud masks.</p></li>
<li><p><code>MAP_FOLDER = map_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the maps.</p></li>
<li><p><code>MAP_BRF = map_brf {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating RGB and B&amp;W maps of the <span class="smallcaps">L1B2</span> Brf fields, before and after fixing.</p></li>
<li><p><code>MAP_QUAL = map_qual {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the <span class="smallcaps">L1B2</span> data quality indicators (in particular RDQI, obscured and edge pixels).</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. Pointers to heap variables containing the fixed <span class="smallcaps">L1B2</span> data buffers are provided as output positional parameters, and the logs, maps and scatterplots are saved in the default or designated folders, if requested.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. Output pointers may be undefined, and maps and other outcomes may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_ptr</code> is not a pointer.</p></li>
<li><p>Error 112: The input positional parameter <code>radrd_ptr</code> is not a pointer.</p></li>
<li><p>Error 114: The input positional parameter <code>rad_ptr</code> is not a pointer.</p></li>
<li><p>Error 116: The input positional parameter <code>brf_ptr</code> is not a pointer.</p></li>
<li><p>Error 118: The input positional parameter <code>rdqi_ptr</code> is not a pointer.</p></li>
<li><p>Error 120: The input positional parameter <code>scalf_ptr</code> is not a pointer.</p></li>
<li><p>Error 122: The input positional parameter <code>convf_ptr</code> is not a pointer.</p></li>
<li><p>Error 130: The optional keyword parameter <code>test_id</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 140: The optional input keyword parameter <code>test_id</code> is set but the keyword parameter <code>first_line</code> is not set or invalid.</p></li>
<li><p>Error 150: The optional input keyword parameter <code>test_id</code> is set but the keyword parameter <code>last_line</code> is not set or invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>agp_folder</code>, <code>rccm_folder</code>, <code>log_folder</code>, <code>save_folder</code>, <code>map_folder</code> is not specified.</p></li>
<li><p>Error 400: The output directory <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The output directory <code>save_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>map_l1b2.pro</code>.</p></li>
<li><p>Error 510: An exception condition occurred in function <code>heap_l1b2_block.pro</code>.</p></li>
<li><p>Error 520: An exception condition occurred in function <code>mk_l1b2_masks.pro</code>.</p></li>
<li><p>Error 530: An exception condition occurred in function <code>mk_l1b2_masks.pro</code>.</p></li>
<li><p>Error 540: An exception condition occurred in function <code>pre_fix_l1b2.pro</code>.</p></li>
<li><p>Error 550: An exception condition occurred in function <code>fix_poor_l1b2.pro</code>.</p></li>
<li><p>Error 560: An exception condition occurred in function <code>fix_miss_l1b2.pro</code>.</p></li>
<li><p>Error 570: An exception condition occurred in function <code>map_l1b2.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>fix_miss_l1b2.pro</code></p></li>
<li><p><code>fix_poor_l1b2.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>heap_l1b2_block.pro</code></p></li>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_integer.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>map_l1b2.pro</code></p></li>
<li><p><code>mk_l1b2_masks.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>pre_fix_l1b2.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>str2block.pro</code></p></li>
<li><p><code>str2orbit.pro</code></p></li>
<li><p><code>str2path.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> WARNING: If (1) the <span class="smallcaps">L1B2</span> data set to be upgraded is from a Global Mode acquisition, (2) the target data channel is available at the native resolution of 275 m, and (3) the best source data channel is available at the reduced spatial resolution of 1100 m, then the map of the upgraded <span class="smallcaps">L1B2</span> product will appear fuzzier in those upgraded areas than in untouched areas. This effect may be particularly noticeable if the <span class="smallcaps">L1B2</span> data product also contains a large number of poor data values and the optional input keyword parameter <code>ALSO_POOR</code> is set to a non-zero value.</p></li>
<li><p><strong>Note 2:</strong> WARNING: In most cases, replacing bad or poor <span class="smallcaps">L1B2</span> values by best estimates should be feasible using the optimally correlated source data channel. On rare occasions, the target and the optimal source data channels may both contain bad or poor values in the same location. Setting the optional keyword parameter <code>n_attempts</code> to values larger than 1 allows the code to consider the next best performing source data channels to achieve the desired goal. This keyword is currently capped at 8 because the reliability of predicting equations beyond that often becomes insufficient.</p></li>
<li><p><strong>Note 3:</strong> The optional input keyword parameters <code>L1B2GM_FOLDER</code> and <code>L1B2GM_VERSION</code> are not needed when processing Global Mode data. However, the basic land, water and cloud cover masks are always generated at the reduced resolution of 1100 m. Hence, when processing Local Mode data with the input keyword parameter <code>n_masks</code> set to <code>3</code> (i.e., requiring the identification of clear land, clear water and cloudy areas), an additional call to the function <code>heap_l1b2_block</code> is made to temporarily place the required Global Mode data on the heap, and this step requires access to the corresponding folder and version, if they are different from the default values.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39;GM&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050L
IDL&gt; misr_block = 110
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = heap_l1b2_block(misr_mode, misr_path, $
   misr_orbit, misr_block, misr_ptr, radrd_ptr, $
   rad_ptr, brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, $
   L1B2GM_FOLDER = l1b2gm_folder, $
   L1B2GM_VERSION = l1b2gm_version, $
   L1B2LM_FOLDER = l1b2lm_folder, $
   L1B2LM_VERSION = l1b2lm_version, $
   MISR_SITE = misr_site, VERBOSE = verbose, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; agp_folder = &#39;&#39;
IDL&gt; agp_version = &#39;&#39;
IDL&gt; rccm_folder = &#39;&#39;
IDL&gt; rccm_version = &#39;&#39;
IDL&gt; n_masks = 3
IDL&gt; also_poor = 0
IDL&gt; n_attempts = 4
IDL&gt; log_it = 1
IDL&gt; log_folder = &#39;&#39;
IDL&gt; save_it = 1
IDL&gt; save_folder = &#39;&#39;
IDL&gt; scatt_it = 1
IDL&gt; scatt_folder = &#39;&#39;
IDL&gt; set_min_scatt = &#39;&#39;
IDL&gt; set_max_scatt = &#39;&#39;
IDL&gt; map_it = 1
IDL&gt; map_folder = &#39;&#39;
IDL&gt; map_brf = 1
IDL&gt; map_qual = 1
IDL&gt; rc = fix_l1b2(misr_ptr, radrd_ptr, rad_ptr, $
   brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, $
   fixed_misr_ptr, fixed_radrd_ptr, fixed_rad_ptr, $
   fixed_brf_ptr, fixed_rdqi_ptr, $
   AGP_FOLDER = agp_folder, AGP_VERSION = agp_version, $
   L1B2GM_FOLDER = l1b2gm_folder, $
   L1B2GM_VERSION = l1b2gm_version, $
   RCCM_FOLDER = rccm_folder, $
   RCCM_VERSION = rccm_version, $
   N_MASKS = n_masks, ALSO_POOR = also_poor, $
   N_ATTEMPTS = n_attempts, $
   LOG_IT = log_it, LOG_FOLDER = log_folder, $
   SAVE_IT = save_it, SAVE_FOLDER = save_folder, $
   SCATT_IT = scatt_it, SCATT_FOLDER = scatt_folder, $
   SET_MIN_SCATT = set_min_scatt, $
   SET_MAX_SCATT = set_max_scatt, $
   MAP_IT = map_it, MAP_FOLDER = map_folder, $
   MAP_BRF = map_brf, MAP_QUAL = map_qual, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;28: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2019&#8211;03&#8211;06: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;03&#8211;08: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;19: Version 2.01 &#8212; Add the optional input keyword parameter <code>ALSO_POOR</code> to enable the user to replace poor data values in the same way as bad data values.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.02 &#8212; Upgrade the code to allow the use of the up to <code>N_ATTEMPTS</code> best statistical relations to replace the bad (missing) or poor (if requested) values, in case the first option is not applicable.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.11 &#8212; Update the code to use the more detailed masks generated by the latest versions of <code>mk_l1b2_masks.pro</code> and <code>best_fits_l1b2.pro</code>.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.12 &#8212; Update the code to use more explicit variable names for storing the results of best fits.</p></li>
<li><p>2019&#8211;04&#8211;19: Version 2.13 &#8212; Simplify the code by forcing <code>n_masks</code> to be <code>3</code>, i.e., by always distinguishing between clear land masses, clear water bodies and cloud fields, and add the pointers to the original <span class="smallcaps">MISR</span> data to the output positional parameter list.</p></li>
<li><p>2019&#8211;04&#8211;24: Version 2.14 &#8212; Adjust the code to use the new version of function <code>heap_l1b2_block.pro</code> which also returns the conversion factors, add the optional input keyword parameter <code>N_MASKS</code>, and add diagnostic information about the number of unusable source values and the the number of unusable negative replacement values in the log file.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.15 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.16 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.17 &#8212; Update the code to externalize the acquisition of <span class="smallcaps">L1B2</span> data (the function <code>heap_l1b2_block.pro</code> must be called only once prior to processing <span class="smallcaps">RCCM</span>, <span class="smallcaps">L1B2</span> or <span class="smallcaps">L1B3</span> data) and to allow the processing of Local Mode data (which does require an extra call to <code>heap_l1b2_block.pro</code>, as noted above).</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;17: Version 2.1.1 &#8212; Add the keywords <code>TEST_ID</code>, <code>FIRST_LINE</code> and <code>LAST_LINE</code> to include additional information in the map legends whenever missing data have been artificially inserted in the <span class="smallcaps">L1B2</span> data buffers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.2 &#8212; Update the code to modify the default log, map and savefile output directories, and use the current version of the function <code>hr2lr.pro</code>.</p></li>
<li><p>2019&#8211;10&#8211;23: Version 2.2.0 &#8212; Major rewrite of the function <code>fix_l1b2.pro</code>, breaking it up into smaller routines, including this one, and optionally replacing poor values before processing missing values.</p></li>
</ul></li>
</ul>
<h2>fix_miss_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function replaces the missing radiance values found in the 36 <span class="smallcaps">L1B2</span> databuffers of the input <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> by optimal esimates.</p></li>
<li><p><strong>Algorithm:</strong> This function replaces the missing radiance values (scaled radiance value with <span class="smallcaps">RDQI</span> attached of <code>65523U</code>) identified by the function <code>pre_fix_l1b2.pro</code> by estimates based on the best fits between the target data channel and the 35 other source data channels and resets their <span class="smallcaps">RDQI</span> to <code>1B</code>. The input keyword parameter <code>N_ATTEMPTS</code> controls how many attempts are allowed to replace the missing values, using successive best fits in decreasing order of correlation coefficient between the target and the source databuffers.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = fix_miss_l1b2(misr_ptr, radrd_ptr, rad_ptr, $</code><br />
<code>brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, lwc_mask_ptr, $</code><br />
<code>fixed_misr_ptr, fixed_radrd_ptr, fixed_rad_ptr, $</code><br />
<code>fixed_brf_ptr, fixed_rdqi_ptr, n_miss_lnd_ptr, idx_miss_lnd_ptr, $</code><br />
<code>n_miss_wat_ptr, idx_miss_wat_ptr, n_miss_cld_ptr, $</code><br />
<code>idx_miss_cld_ptr, best_fits_ptr, N_MASKS = n_masks, $</code><br />
<code>N_ATTEMPTS = n_attempts, $</code><br />
<code>MAIN_LOG_IT = main_log_it, MAIN_LOG_UNIT = main_log_unit, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 4 pointer arrays.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA).</p></li>
<li><p><code>rad_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA).</p></li>
<li><p><code>brf_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF to DA).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF to DA).</p></li>
<li><p><code>scalf_ptr {POINTER array} [I]:</code> The array of 36 <code>DOUBLE</code> scale factors used to convert the unsigned 14-bit integer data into radiance measurements, in units of W m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;2</sup></span> sr<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span> <span class="math inline"><em>&#956;</em></span>m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span>.</p></li>
<li><p><code>convf_ptr {POINTER array} [I]:</code> The array of 36 pointers to the data buffers containing the <code>FLOAT</code> conversion factor arrays to convert radiances into bidirectional reflectance factors.</p></li>
<li><p><code>lwc_mask_ptr {POINTER array} [I]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the <code>BYTE</code> masks containing the information on the spatial distribution of geophysical media to consider, as defined by <code>n_masks</code>.</p></li>
<li><p><code>fixed_misr_ptr {POINTER} [I/O]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 4 pointer arrays.</p></li>
<li><p><code>fixed_radrd_ptr {POINTER array} [I/O]:</code> The array of 36 pointers to the updated <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA).</p></li>
<li><p><code>fixed_rad_ptr {POINTER array} [I/O]:</code> The array of 36 pointers to the updated <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA).</p></li>
<li><p><code>fixed_brf_ptr {POINTER array} [I/O]:</code> The array of 36 pointers to the updated <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF to DA).</p></li>
<li><p><code>fixed_rdqi_ptr {POINTER array} [I/O]:</code> The array of 36 pointers to the updated <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF to DA).</p></li>
<li><p><code>n_miss_lnd_ptr {POINTER array} [I/O]:</code> The array of pointers to the number of missing pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_miss_lnd_ptr {POINTER array} [I/O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the missing pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_miss_wat_ptr {POINTER array} [I/O]:</code> The array of pointers to the number of missing pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_miss_wat_ptr {POINTER array} [I/O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the missing pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_miss_cld_ptr {POINTER array} [I/O]:</code> The array of pointers to the number of missing pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_miss_cld_ptr {POINTER array} [I/O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the missing pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>best_fits_ptr {POINTER array} [I]:</code> The array of pointers to the output structures containing the statistical information on the correlation between the targets and the source data channels.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>N_MASKS = n_masks {INT} [I] (Default value: 3):</code> The number of target types that need to be discriminated by the masks: <code>1</code> to generate a single mask for all geophysical target types, <code>2</code> to generate masks separately for land masses and water bodies, or <code>3</code> to generate masks separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><code>N_ATTEMPTS = n_attempts {INT} [I] (Default value: 1):</code> Flag to indicate the maximum number of &#8216;best&#8217; linear fit equations can be considered when trying to replace bad (missing) or optionally missing <span class="smallcaps">L1B2</span> values.</p></li>
<li><p><code>MAIN_LOG_IT = main_log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) writing intermediary results to a pre-existing log file.</p></li>
<li><p><code>MAIN_LOG_UNIT = main_log_unit {IDL Logical Unit Number} [I] (Default: None):</code> The IDL Logical Unit Number of the main log file, which must be opened for writing prior to calling this function.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code> contain the results generated by this function.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code> may be incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: At least one of the following input positional parameters is not a pointer: <code>misr_ptr</code>, <code>radrd_ptr</code>, <code>rad_ptr</code>, <code>brf_ptr</code>, <code>rdqi_ptr</code>, <code>scalf_ptr</code>, <code>convf_ptr</code>.</p></li>
<li><p>Error 120: At least one of the following input positional parameters is not a pointer: <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code>.</p></li>
<li><p>Error 130: At least one of the following input positional parameters is not a pointer: <code>n_miss_lnd_ptr</code>, <code>idx_miss_lnd_ptr</code>, <code>n_miss_wat_ptr</code>, <code>idx_miss_wat_ptr</code>, <code>n_miss_cld_ptr</code>, <code>idx_miss_cld_ptr</code>, <code>best_fits_ptr</code>.</p></li>
<li><p>Error 200: Unrecognized camera name in retrieving best fits for missing land pixels.</p></li>
<li><p>Error 202: Unrecognized spectral band name in retrieving best fits for missing land pixels.</p></li>
<li><p>Error 210: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 211: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 212: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 213: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 214: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 215: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 216: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 217: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 218: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 219: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 220: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 230: Unrecognized camera name in retrieving best fits for missing water pixels.</p></li>
<li><p>Error 232: Unrecognized spectral band name in retrieving best fits for missing water pixels.</p></li>
<li><p>Error 240: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 241: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 242: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 243: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 244: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 245: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 246: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 247: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 248: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 249: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 250: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 260: Unrecognized camera name in retrieving best fits for missing cloud pixels.</p></li>
<li><p>Error 262: Unrecognized spectral band name in retrieving best fits for missing cloud pixels.</p></li>
<li><p>Error 270: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 271: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 272: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 273: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 274: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 275: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 276: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 277: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 278: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 279: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 280: An exception condition occurred in <code>lr2hr</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>hr2lr.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> In the section describing the positional parameters above, the variables <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code>, <code>n_miss_lnd_ptr</code>, <code>idx_miss_lnd_ptr</code>, <code>n_miss_wat_ptr</code>, <code>idx_miss_wat_ptr</code>, <code>n_miss_cld_ptr</code> and <code>idx_miss_cld_ptr</code> are described as both input and output because they must be initialized with the original values prior to calling this function, and may be subsequently updated as needed by this function.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_l1b2.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;28: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2019&#8211;03&#8211;06: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;03&#8211;08: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;19: Version 2.01 &#8212; Add the optional input keyword parameter <code>ALSO_POOR</code> to enable the user to replace poor data values in the same way as bad data values.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.02 &#8212; Upgrade the code to allow the use of the up to <code>N_ATTEMPTS</code> best statistical relations to replace the bad (missing) or poor (if requested) values, in case the first option is not applicable.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.11 &#8212; Update the code to use the more detailed masks generated by the latest versions of <code>mk_l1b2_masks.pro</code> and <code>best_fits_l1b2.pro</code>.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.12 &#8212; Update the code to use more explicit variable names for storing the results of best fits.</p></li>
<li><p>2019&#8211;04&#8211;19: Version 2.13 &#8212; Simplify the code by forcing <code>n_masks</code> to be <code>3</code>, i.e., by always distinguishing between clear land masses, clear water bodies and cloud fields, and add the pointers to the original <span class="smallcaps">MISR</span> data to the output positional parameter list.</p></li>
<li><p>2019&#8211;04&#8211;24: Version 2.14 &#8212; Adjust the code to use the new version of function <code>heap_l1b2_block.pro</code> which also returns the conversion factors, add the optional input keyword parameter <code>N_MASKS</code>, and add diagnostic information about the number of unusable source values and the the number of unusable negative replacement values in the log file.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.15 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.16 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.17 &#8212; Update the code to externalize the acquisition of <span class="smallcaps">L1B2</span> data (the function <code>heap_l1b2_block.pro</code> must be called only once prior to processing <span class="smallcaps">RCCM</span>, <span class="smallcaps">L1B2</span> or <span class="smallcaps">L1B3</span> data) and to allow the processing of Local Mode data (which does require an extra call to <code>heap_l1b2_block.pro</code>, as noted above).</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;17: Version 2.1.1 &#8212; Add the keywords <code>TEST_ID</code>, <code>FIRST_LINE</code> and <code>LAST_LINE</code> to include additional information in the map legends whenever missing data have been artificially inserted in the <span class="smallcaps">L1B2</span> data buffers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.2 &#8212; Update the code to modify the default log, map and savefile output directories, and use the current version of the function <code>hr2lr.pro</code>.</p></li>
<li><p>2019&#8211;10&#8211;23: Version 2.2.0 &#8212; Major rewrite of the function <code>fix_l1b2.pro</code>, breaking it up into smaller routines, including this one, and optionally replacing poor values before processing missing values.</p></li>
</ul></li>
</ul>
<h2>fix_poor_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function replaces the poor radiance values found in the 36 <span class="smallcaps">L1B2</span> databuffers of the input <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> by optimal esimates.</p></li>
<li><p><strong>Algorithm:</strong> This function replaces the poor radiance values (<span class="smallcaps">RDQI</span> of <code>2B</code>) identified by the function <code>pre_fix_l1b2.pro</code> by estimates based on the best fits between the target data channel and the 35 other source data channels and resets their <span class="smallcaps">RDQI</span> to <code>1B</code>. The input keyword parameter <code>N_ATTEMPTS</code> controls how many attempts are allowed to replace the poor values, using successive best fits in decreasing order of correlation coefficient between the target and the source databuffers. The input keyword parameter <code>SCATT_IT</code> controls whether scatterplots of the updated versus original poor values are saved in the specified or default folder.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = fix_poor_l1b2(misr_ptr, radrd_ptr, rad_ptr, $</code><br />
<code>brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, lwc_mask_ptr, $</code><br />
<code>fixed_misr_ptr, fixed_radrd_ptr, fixed_rad_ptr, $</code><br />
<code>fixed_brf_ptr, fixed_rdqi_ptr, n_poor_lnd_ptr, idx_poor_lnd_ptr, $</code><br />
<code>n_poor_wat_ptr, idx_poor_wat_ptr, n_poor_cld_ptr, $</code><br />
<code>idx_poor_cld_ptr, best_fits_ptr, N_MASKS = n_masks, $</code><br />
<code>N_ATTEMPTS = n_attempts, $</code><br />
<code>MAIN_LOG_IT = main_log_it, MAIN_LOG_UNIT = main_log_unit, $</code><br />
<code>SCATT_IT = scatt_it, SCATT_FOLDER = scatt_folder,$</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 4 pointer arrays.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>rad_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> unscaled radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>brf_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [O]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>scalf_ptr {POINTER array} [O]:</code> The array of 36 <code>DOUBLE</code> scale factors used to convert the unsigned 14-bit integer data into radiance measurements, in units of W m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;2</sup></span> sr<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span> <span class="math inline"><em>&#956;</em></span>m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span>.</p></li>
<li><p><code>convf_ptr {POINTER array} [O]:</code> The array of 36 pointers to the data buffers containing the <code>FLOAT</code> conversion factor arrays to convert radiances into bidirectional reflectance factors.</p></li>
<li><p><code>lwc_mask_ptr {POINTER array} [I]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the <code>BYTE</code> masks containing the information on the spatial distribution of geophysical media to consider, as defined by <code>n_masks</code>.</p></li>
<li><p><code>fixed_misr_ptr {POINTER} [O]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 4 pointer arrays.</p></li>
<li><p><code>fixed_radrd_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>fixed_radrd_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> unscaled radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>fixed_brf_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>fixed_rdqi_ptr {POINTER array} [O]:</code> The array of 36 pointers to the fixed <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>n_poor_lnd_ptr {POINTER array} [I/O]:</code> The array of pointers to the number of poor pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_poor_lnd_ptr {POINTER array} [I/O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the poor pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_poor_wat_ptr {POINTER array} [I/O]:</code> The array of pointers to the number of poor pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_poor_wat_ptr {POINTER array} [I/O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the poor pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_poor_cld_ptr {POINTER array} [I/O]:</code> The array of pointers to the number of poor pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_poor_cld_ptr {POINTER array} [I/O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the poor pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>best_fits_ptr {POINTER array} [I]:</code> The array of pointers to the output structures containing the statistical information on the correlation between the targets and the source data channels.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>N_MASKS = n_masks {INT} [I] (Default value: 3):</code> The number of target types that need to be discriminated by the masks: <code>1</code> to generate a single mask for all geophysical target types, <code>2</code> to generate masks separately for land masses and water bodies, or <code>3</code> to generate masks separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><code>N_ATTEMPTS = n_attempts {INT} [I] (Default value: 1):</code> Flag to indicate the maximum number of &#8216;best&#8217; linear fit equations can be considered when trying to replace bad (missing) or optionally poor <span class="smallcaps">L1B2</span> values.</p></li>
<li><p><code>MAIN_LOG_IT = main_log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) writing intermediary results to a pre-existing log file.</p></li>
<li><p><code>MAIN_LOG_UNIT = main_log_unit {IDL Logical Unit Number} [I] (Default: None):</code> The IDL Logical Unit Number of the main log file, which must be opened for writing prior to calling this function.</p></li>
<li><p><code>SCATT_IT = scatt_it {INT} [I] (Default value: 0):</code> Flag to generate (1) or skip (0) a scatterplot of the two best correlated data channels for each of the cases specified by <code>n_masks</code>.</p></li>
<li><p><code>SCATT_FOLDER = scatt_folder {STRING} [I]:</code> The directory address of the output folder containing the scatterplots, if different from the value implied by the default set by function <code>set_roots_vers.pro)</code> and the routine arguments.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code> contain the results generated by this function.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code> may be incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: At least one of the following input positional parameters is not a pointer: <code>misr_ptr</code>, <code>radrd_ptr</code>, <code>rad_ptr</code>, <code>brf_ptr</code>, <code>rdqi_ptr</code>, <code>scalf_ptr</code>, <code>convf_ptr</code>.</p></li>
<li><p>Error 120: At least one of the following input positional parameters is not a pointer: <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code>.</p></li>
<li><p>Error 130: At least one of the following input positional parameters is not a pointer: <code>n_poor_lnd_ptr</code>, <code>idx_poor_lnd_ptr</code>, <code>n_poor_wat_ptr</code>, <code>idx_poor_wat_ptr</code>, <code>n_poor_cld_ptr</code>, <code>idx_poor_cld_ptr</code>, <code>best_fits_ptr</code>.</p></li>
<li><p>Error 140: The input keyword parameter <code>main_log_unit</code> does not point to a writable file.</p></li>
<li><p>Error 200: Unrecognized camera name in retrieving best fits for poor land pixels.</p></li>
<li><p>Error 202: Unrecognized spectral band name in retrieving best fits for poor land pixels.</p></li>
<li><p>Error 210: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 211: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 212: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 213: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 214: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 215: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 216: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 217: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 218: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 219: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 220: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 230: Unrecognized camera name in retrieving best fits for poor water pixels.</p></li>
<li><p>Error 232: Unrecognized spectral band name in retrieving best fits for poor water pixels.</p></li>
<li><p>Error 240: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 241: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 242: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 243: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 244: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 245: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 246: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 247: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 248: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 249: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 250: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 260: Unrecognized camera name in retrieving best fits for poor cloud pixels.</p></li>
<li><p>Error 262: Unrecognized spectral band name in retrieving best fits for poor cloud pixels.</p></li>
<li><p>Error 270: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 271: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 272: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 273: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 274: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 275: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 276: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 277: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 278: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 279: An exception condition occurred in <code>hr2lr</code>.</p></li>
<li><p>Error 280: An exception condition occurred in <code>lr2hr</code>.</p></li>
<li><p>Error 400: The output folder <code>scatt_path</code> is unwritable.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>hr2lr.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> In the section describing the positional parameters above, the variables <code>fixed_misr_ptr</code>, <code>fixed_radrd_ptr</code>, <code>fixed_rad_ptr</code>, <code>fixed_brf_ptr</code>, <code>fixed_rdqi_ptr</code>, <code>n_poor_lnd_ptr</code>, <code>idx_poor_lnd_ptr</code>, <code>n_poor_wat_ptr</code>, <code>idx_poor_wat_ptr</code>, <code>n_poor_cld_ptr</code> and <code>idx_poor_cld_ptr</code> are described as both input and output because they must be initialized with the original values prior to calling this function, and may be subsequently updated as needed by this function.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_l1b2.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;28: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2019&#8211;03&#8211;06: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;03&#8211;08: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;19: Version 2.01 &#8212; Add the optional input keyword parameter <code>ALSO_POOR</code> to enable the user to replace poor data values in the same way as bad data values.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.02 &#8212; Upgrade the code to allow the use of the up to <code>N_ATTEMPTS</code> best statistical relations to replace the bad (missing) or poor (if requested) values, in case the first option is not applicable.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.11 &#8212; Update the code to use the more detailed masks generated by the latest versions of <code>mk_l1b2_masks.pro</code> and <code>best_fits_l1b2.pro</code>.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.12 &#8212; Update the code to use more explicit variable names for storing the results of best fits.</p></li>
<li><p>2019&#8211;04&#8211;19: Version 2.13 &#8212; Simplify the code by forcing <code>n_masks</code> to be <code>3</code>, i.e., by always distinguishing between clear land masses, clear water bodies and cloud fields, and add the pointers to the original <span class="smallcaps">MISR</span> data to the output positional parameter list.</p></li>
<li><p>2019&#8211;04&#8211;24: Version 2.14 &#8212; Adjust the code to use the new version of function <code>heap_l1b2_block.pro</code> which also returns the conversion factors, add the optional input keyword parameter <code>N_MASKS</code>, and add diagnostic information about the number of unusable source values and the the number of unusable negative replacement values in the log file.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.15 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.16 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.17 &#8212; Update the code to externalize the acquisition of <span class="smallcaps">L1B2</span> data (the function <code>heap_l1b2_block.pro</code> must be called only once prior to processing <span class="smallcaps">RCCM</span>, <span class="smallcaps">L1B2</span> or <span class="smallcaps">L1B3</span> data) and to allow the processing of Local Mode data (which does require an extra call to <code>heap_l1b2_block.pro</code>, as noted above).</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;17: Version 2.1.1 &#8212; Add the keywords <code>TEST_ID</code>, <code>FIRST_LINE</code> and <code>LAST_LINE</code> to include additional information in the map legends whenever missing data have been artificially inserted in the <span class="smallcaps">L1B2</span> data buffers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.2 &#8212; Update the code to modify the default log, map and savefile output directories, and use the current version of the function <code>hr2lr.pro</code>.</p></li>
<li><p>2019&#8211;10&#8211;23: Version 2.2.0 &#8212; Major rewrite of the function <code>fix_l1b2.pro</code>, breaking it up into smaller routines, including this one, and optionally replacing poor values before processing missing values; this version also includes the possibility of generating scatterplots of the updated versus the original <span class="smallcaps">RDQI</span> values, for each of the affected data channels.</p></li>
</ul></li>
</ul>
<h2>heap_l1b2_block</h2>
<ul>
<li><p><strong>Purpose:</strong> This function provides convenient global access to the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> <span class="smallcaps">GRP</span> data contained in the 9 files specified by the input positional parameters <code>misr_mode</code>, <code>misr_path</code>, <code>misr_orbit</code>, and <code>misr_block</code>. It can also optionally insert missing data in one or more of those files for testing purposes.</p></li>
<li><p><strong>Algorithm:</strong> This function reads the various data fields contained in the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> <span class="smallcaps">GRP</span> files specified by the input positional parameters and makes them available through globally accessible pointers on the heap. If the optional keyword parameter <code>test_id</code> is not a null string, this function saves the original <span class="smallcaps">L1B2</span> data and replaces missing data</p></li>
<li><p><strong>Syntax:</strong> <code>rc = heap_l1b2_block(misr_mode, misr_path, misr_orbit, $</code><br />
<code>misr_block, misr_ptr, radrd_ptr, rad_ptr, $</code><br />
<code>brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, $</code><br />
<code>L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $</code><br />
<code>L1B2LM_FOLDER = l1b2lm_folder, L1B2LM_VERSION = l1b2lm_version, $</code><br />
<code>MISR_SITE = misr_site, TEST_ID = test_id, $</code><br />
<code>FIRST_LINE = first_line, LAST_LINE = last_line, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>.</p></li>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_block {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>misr_ptr {POINTER} [O]:</code> The pointer to a 4-elements <code>STRING</code> array where <code>misr_ptr [0]</code> contains the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <code>misr_ptr [1]</code> contains the <span class="smallcaps">Path</span> number, <code>misr_ptr [2]</code> contains the <span class="smallcaps">Orbit</span> number, and <code>misr_ptr [3]</code> contains the <span class="smallcaps">Block</span> number.</p></li>
<li><p><code>radrd_ptr {POINTER array} [O]:</code> The 36-elements pointer array to <code>UINT</code> arrays containing the 16 bit <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (<span class="smallcaps">DF</span>/Blue to <span class="smallcaps">DA</span>/NIR).</p></li>
<li><p><code>rad_ptr {POINTER array} [O]:</code> The 36-elements pointer array to <code>FLOAT</code> arrays containing the 32 bit <span class="smallcaps">L1B2</span> unscaled radiance values, in the native order (<span class="smallcaps">DF</span>/Blue to <span class="smallcaps">DA</span>/NIR).</p></li>
<li><p><code>brf_ptr {POINTER array} [O]:</code> The 36-elements pointer array to <code>FLOAT</code> arrays containing the 32 bit <span class="smallcaps">L1B2</span> bidirectional reflectance factors, in the native order (<span class="smallcaps">DF</span>/Blue to <span class="smallcaps">DA</span>/NIR).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [O]:</code> The 36-elements pointer array to <code>BYTE</code> arrays containing the 8 bit <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (<span class="smallcaps">DF</span>/Blue to <span class="smallcaps">DA</span>/NIR).</p></li>
<li><p><code>scalf_ptr {POINTER array} [O]:</code> The 36-elements pointer array to <code>DOUBLE</code> (precision) 64 bit scale factors used to convert the unsigned 14-bit integer data into radiance measurements, in units of W m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;2</sup></span> sr<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span> <span class="math inline"><em>&#956;</em></span>m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span>:<br />
<em>Radiance (FLOAT) = Scaled radiance (UINT)<span class="math inline">&#215;</span> scale_factor (DOUBLE)</em></p></li>
<li><p><code>convf_ptr {POINTER array} [O]:</code> The 36-elements pointer array to <code>FLOAT</code> arrays containing the 32 bit conversion factors used to convert radiances into bidirectional reflectance factors:<br />
<em>Brf (FLOAT) = Radiance (FLOAT)<span class="math inline">&#215;</span> conversion_factor</em></p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GM files, if they are not located in the default location.</p></li>
<li><p><code>L1B2GM_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> GM version identifier to use instead of the default value.</p></li>
<li><p><code>L1B2LM_FOLDER = l1b2lm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> LM files, if they are not located in the default location.</p></li>
<li><p><code>L1B2LM_VERSION = l1b2lm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">L1B2</span> LM version identifier to use instead of the default value.</p></li>
<li><p><code>MISR_SITE = misr_site {STRING} [I] (Default value: None</code>: The selected <span class="smallcaps">MISR</span> Site name.</p></li>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> Flag to activate (<code>non-empty STRING</code>) or skip (<code>empty STRING</code>) artificially introducing missing data in the L1B2 data buffer; if set, this keyword is used in output file names to label experiments.</p></li>
<li><p><code>FIRST_LINE = first_line {INT array of 36 elements} [I] (Default value: 36 elements set to -1):</code> The index (between 0 and 127 [for GM data] or 511 [for LM data]) of the first line to be replaced by missing data, in the corresponding cameras and spectral bands. Values outside that range are ignored.</p></li>
<li><p><code>LAST_LINE = last_line {INT array of 36 elements} [I] (Default value: 36 elements set to -1):</code> The index (between 0 and 127 [for GM data] or 511 [for LM data]) of the last line to be replaced by missing data, in the corresponding cameras and spectral bands. Values outside that range are ignored.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data buffers are loaded on the heap and globally reachable through pointers, within the current program.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data buffers may not have been loaded on the heap.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 120: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 130: The input positional parameter <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 132: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 134: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 136: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 140: The input positional parameter <code>misr_block</code> is invalid.</p></li>
<li><p>Error 150: Local Mode data are requested but the keyword parameter <code>MISR_SITE</code> is not specified.</p></li>
<li><p>Error 160: The optional keyword parameter <code>test_id</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 170: The optional input keyword parameter <code>test_id</code> is set but the keyword parameter <code>first_line</code> is not set or invalid.</p></li>
<li><p>Error 180: The optional input keyword parameter <code>test_id</code> is set but the keyword parameter <code>last_line</code> is not set or invalid.</p></li>
<li><p>Error 190: At least one of the couples (<code>first_line</code>, <code>last_line</code>) is inconsistent.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 300: An exception condition occurred in function <code>find_l1b2gm_files.pro</code>.</p></li>
<li><p>Error 310: An exception condition occurred in function <code>find_l1b2lm_files.pro</code>.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 510: An exception condition occurred in function <code>orbit2str.pro</code>.</p></li>
<li><p>Error 520: An exception condition occurred in function <code>block2str.pro</code>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_SETREGION_BY_PATH_BLOCKRANGE</code>.</p></li>
<li><p>Error 610: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading one of the <code>l1b2_files</code> to extract the scaled Radiance/RDQI values.</p></li>
<li><p>Error 620: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading one of the <code>l1b2_files</code> to extract the unscaled Radiance values.</p></li>
<li><p>Error 630: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading one of the <code>l1b2_files</code> to extract the Brf values.</p></li>
<li><p>Error 640: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading one of the <code>l1b2_files</code> to extract the RDQI values.</p></li>
<li><p>Error 650: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_GRIDATTR_GET</code>.</p></li>
<li><p>Error 660: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_READDATA</code> while reading one of the <code>l1b2_files</code> to extract the BRF Conversion Factor values.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>block2str.pro</code></p></li>
<li><p><code>chk_misr_block.pro</code></p></li>
<li><p><code>chk_misr_mode.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>find_l1b2gm_files.pro</code></p></li>
<li><p><code>find_l1b2lm_files.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>orbit2str.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function loads all main data fields for each of the 36 L1B2 data channels (9 cameras by 4 spectral bands) corresponding to a <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, and <span class="smallcaps">Block</span> on the heap and makes them globally available through pointers. For instance,</p>
<ul>
<li><p>The data buffer containing the scaled radiance (with the RDQI attached) values for the CF camera in the NIR spectral band is accessible as <code>rad_cf_nir = *radrd_ptr[1, 3]</code>, where the index <code>1</code> refers to the second camera (CF) and where the index <code>3</code> refers to the fourth spectral band (NIR).</p></li>
<li><p>A particular pixel value (e.g., at location <code>[203, 52]</code>) within that data buffer is then accessed as if the buffer had been read from the file: <code>rad_cf_nir[203, 52]</code>.</p></li>
<li><p>Similarly, the data buffer containing the Brf values for the BA camera in the Green spectral band is accessible as <code>brf_ba_green = *brf_ptr[6, 1]</code>.</p></li>
<li><p>And the data buffer containing the RDQI values for the AN camera in the red spectral band is accessible as <code>rdqi_an_red = *rdqi_ptr[5, 2]</code>.</p></li>
</ul></li>
<li><p><strong>Note 2:</strong> The 36 scale factors are <code>DOUBLE</code> values, one per camera and spectral band.</p></li>
<li><p><strong>Note 3:</strong> The 36 conversion factors available in the L1B2 files are provided on a grid of 32 samples by 8 lines for each <span class="smallcaps">Block</span>, i.e., at a sampling distance of 17.6 km. Instead, the conversion factors contained in the arrays <code>convf_ptr</code> provide values for each individual pixel, i.e., at whatever spatial resolution this particular data channel is available. The fill values on the extreme edges of the <span class="smallcaps">Block</span> are <code>-444.0</code>, as in the original data.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39;GM&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; misr_block = 110
IDL&gt; rc = heap_l1b2_block(misr_mode, misr_path, misr_orbit, $
   misr_block, misr_ptr, radrd_ptr, rad_ptr, brf_ptr, $
   rdqi_ptr, scalf_ptr, convf_ptr, $
   L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $
   L1B2LM_FOLDER = l1b2lm_folder, L1B2LM_VERSION = l1b2lm_version, $
   MISR_SITE = misr_site, VERBOSE = verbose, $
   DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; HELP, radrd_ptr
RADRD_PTR       POINTER   = Array[9, 4]
IDL&gt; rad_cf_nir = *radrd_ptr[1, 3]
IDL&gt; PRINT, &#39;rad_cf_nir[200, 120] = &#39; + $
   strstr(rad_cf_nir[200, 120])
rad_cf_nir[200, 120] = 11652</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Mike Bull, Jason Matthews, Duncan McDonald, Alexander Menzies, Catherine Moroney, Kevin Mueller, Susan Paradise, Mike Smyth (2011) <em>MISR Data Products Specifications</em>, <strong>JPL D-13963</strong>, <strong>Revision S</strong>, Section 6.5.6, p. 72&#8211;73, Jet Propulsion Laboratory, California Institute of Technology, Pasadena, CA, USA.</p></li>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;23: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2019&#8211;02&#8211;25: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.01 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;17: Version 2.02 &#8212; Update the code to retrieve the scale factors used to convert the unsigned 14-bit integer data into radiance measurements, in units of W m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;2</sup></span> sr<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span> <span class="math inline"><em>&#956;</em></span>m<span class="math inline"><em></em><sup>&#8197;&#8722;&#8197;1</sup></span>, and to place the floating point radiance measurements on the heap too.</p></li>
<li><p>2019&#8211;04&#8211;23: Version 2.03 &#8212; Update the code to also provide pointers to the conversion factors needed to convert the radiances into the bidirectional reflectance factors.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.04 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;12: Version 2.05 &#8212; Update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.06 &#8212; Update this function to include a full set of input positional and keyword parameters and call the functions <code>find_l1b2gm_files.pro</code> and <code>find_l1b2lm_files.pro</code> to locate the files: This function now works for either <span class="smallcaps">GM</span> or <span class="smallcaps">LM</span> data.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;17: Version 2.1.1 &#8212; Add the keywords <code>TEST_ID</code>, <code>FIRST_LINE</code> and <code>LAST_LINE</code> to load on the heap <span class="smallcaps">L1B2</span> data buffers with additional missing data inserted for the purpose of testing.</p></li>
</ul></li>
</ul>
<h2>map_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates maps of <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data products and their quality indicators, together with text legends and a log file.</p></li>
<li><p><strong>Algorithm:</strong> This function accesses <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Bidirectional reflectance factor (Brf) data through the pointers <code>misr_ptr</code>, <code>radrd_ptr</code>, <code>brf_ptr</code>, and <code>rdqi_ptr</code> (generated by <code>heap_l1b2_block.pro</code>) and saves some or all of the following files for the <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> specified by the pointer <code>misr_ptr</code>:</p>
<ul>
<li><p>36 color <span class="smallcaps">RDQI</span> maps, one per data channel</p></li>
<li><p>36 legends for the <span class="smallcaps">RDQI</span> maps, one for each <span class="smallcaps">RDQI</span> map</p></li>
<li><p>36 B&amp;W <span class="smallcaps">L1B2</span> maps (with colorbars), one per data channel</p></li>
<li><p>18 colorbars for the B&amp;W <span class="smallcaps">L1B2</span> maps, 9 for the VIS (Blue/Green/Red) and 9 for the NIR data channels</p></li>
<li><p>36 legends for the B&amp;W <span class="smallcaps">L1B2</span> maps, one per data channel</p></li>
<li><p>17 RGB <span class="smallcaps">L1B2</span> maps (without colorbars), two per off-nadir camera (see <code>RGB_LOW</code> and <code>RGB_HIGH</code> below) and one for <span class="smallcaps">AN</span></p></li>
<li><p>17 legends for the RGB <span class="smallcaps">L1B2</span> maps, two per off-nadir camera (see <code>RGB_LOW</code> and <code>RGB_HIGH</code> below) and one for <span class="smallcaps">AN</span></p></li>
<li><p>1 Log file</p></li>
</ul>
<p>The selective generation of output maps is controlled by the following optional keyword parameters:</p>
<ul>
<li><p>If the optional keyword parameter <code>MAP_BRF</code> is set, maps of the bidirectional reflectance at the top of the atmosphere are generated, subject to the setting of the following keywords:</p>
<ul>
<li><p>In Global Mode, if the optional keyword parameter <code>RGB_LOW</code> is set, the <code>RGB</code> map is effectively generated at the reduced spatial resolution of 1100 m (the high-resolution red channel is first spatially averaged to 1.1 km), and the composite map is upscaled to the full spatial resolution for display and comparison purposes.</p></li>
<li><p>In Global Mode, if the optional keyword parameter <code>RGB_HIGH</code> is set, the <code>RGB</code> map is effectively generated at an intermediate spatial resolution as the green and blue data channels are first upscaled to the native spatial resolution of 275 m by duplication, and then combined with the full resolution red data channel.</p></li>
<li><p>In Local Mode, all maps are generated at the full native spatial resolution of the sensor.</p></li>
</ul></li>
<li><p>If the optional keyword parameter <code>PER_BAND</code> is set, black and white maps of all 36 data Brf channels are generated.</p></li>
<li><p>In addition, all the content of all these maps can be stretched to meet specific needs using one ot more of the following keywords:</p>
<ul>
<li><p>If the optional keyword parameter <code>SCL_RGB_MIN</code> is set, its value defines the smallest Brf value recognized by the mapping program for the purpose of representing the blue, green and red data channels.</p></li>
<li><p>If the optional keyword parameter <code>SCL_RGB_MAX</code> is set, its value defines the largest Brf value recognized by the mapping program for the purpose of representing the blue, green and red data channels.</p></li>
<li><p>If the optional keyword parameter <code>SCL_NIR_MIN</code> is set, its value defines the smallest Brf value recognized by the mapping program for the purpose of representing the NIR data channels.</p></li>
<li><p>If the optional keyword parameter <code>SCL_NIR_MAX</code> is set, its value defines the largest Brf value recognized by the mapping program for the purpose of representing the NIR data channels.</p></li>
</ul></li>
<li><p>If the optional keyword parameter <code>MAP_QUAL</code> is set, maps of the quality indicators of the 36 <span class="smallcaps">L1B2</span> data channels are generated. In that case, the color coding of these maps is as follows:</p>
<ul>
<li><p><code>Blue</code>: Good reflectance value (Brf <span class="math inline">&gt;</span> 0.0 and <span class="smallcaps">RDQI</span> = 0).</p></li>
<li><p><code>Green</code>: Fair reflectance value (Brf <span class="math inline">&gt;</span> 0.0 and <span class="smallcaps">RDQI</span> = 1).</p></li>
<li><p><code>Orange</code>: Poor reflectance value (Brf <span class="math inline">&#8805;</span> 0.0 and <span class="smallcaps">RDQI</span> = 2).</p></li>
<li><p><code>Red</code>: Unusable reflectance value (unscale radiance flagged and <span class="smallcaps">RDQI</span> = 3).</p></li>
<li><p><code>Yellow</code>: Pixel obscured by topography.</p></li>
<li><p><code>Black</code>: Pixel unobserved by the camera (edge).</p></li>
</ul></li>
<li><p>Lastly, this function also optionally creates a log file to allow the repeatability and ensure the traceability of these outcomes.</p></li>
</ul></li>
<li><p><strong>Syntax:</strong> <code>rc = map_l1b2(misr_ptr, radrd_ptr, brf_ptr, rdqi_ptr, $</code><br />
<code>prefix, N_MASKS = n_masks, $</code><br />
<code>SCL_RGB_MIN = scl_rgb_min, SCL_RGB_MAX = scl_rgb_max, $</code><br />
<code>SCL_NIR_MIN = scl_nir_min, SCL_NIR_MAX = scl_nir_max, $</code><br />
<code>RGB_LOW = rgb_low, RGB_HIGH = rgb_high, PER_BAND = per_band, $</code><br />
<code>TEST_ID = test_id, FIRST_LINE = first_line, LAST_LINE = last_line, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>MAP_BRF = map_brf, MAP_QUAL = map_qual, $</code><br />
<code>MAP_FOLDER = map_folder, VERBOSE = verbose, $</code><br />
<code>DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 3 pointer arrays.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 pointers to the data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA).</p></li>
<li><p><code>brf_ptr {POINTER array} [I]:</code> The array of 36 pointers to the data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> values, in the native order (DF to DA).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [I]:</code> The array of 36 pointers to the data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF to DA).</p></li>
<li><p><code>prefix {STRING} [I]:</code> The character string to be inserted in the log and map filenames to distinguish outcomes from multiple instances of this function (e.g., when mapping <span class="smallcaps">L1B2</span> data before and after replacing missing values).</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>N_MASKS = n_masks {INT} [I] (Default value: 0):</code> In the context of replacing missing values in <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> data products, this variable can range within <code>[1, 3]</code>, where <code>1</code> forces the best fits to be computed over the entire <span class="smallcaps">Block</span>, deemed to be occupied by the same geophysical medium (typically land), <code>2</code> forces the best fits to be computed separately over land masses and water bodies, and <code>3</code> forces the best fits to be computed separately over clear land masses, clear water bodies and cloud fields. Outside of this context, its value should be <code>0</code>. The only effect of this keyword is to modify the names of map files in such a way that multiple versions can be saved in the same directory.</p></li>
<li><p><code>SCL_RGB_MIN = scl_rgb_min {FLOAT} [I] (Default value: 0.0):</code><br />
The smallest <span class="smallcaps">L1B2</span> GRP ToA radiance to be mapped in the visible (<code>RGB</code>) spectral channels.</p>
<ul>
<li><p>If set to <code>-1.0</code>, the minimum scaling for each of the 3 <code>RGB</code> channels will be set to the minimum non-zero value found in those channels (actual stretching).</p></li>
<li><p>If set to <code>0.0</code> (or not set), the minimum scaling for each of the 3 <code>RGB</code> channels will be set to <code>0.0</code> (standard stretching).</p></li>
<li><p>If set to a positive value, the minimum scaling for each of the 3 <code>RGB</code> channels will be set to the indicated value (specified stretching).</p></li>
</ul></li>
<li><p><code>SCL_RGB_MAX = scl_rgb_max {FLOAT} [I] (Default value: 0.35):</code><br />
The largest unscaled <span class="smallcaps">L1B2</span> GRP ToA radiance to be mapped in the visible (<span class="smallcaps">RGB</span>) spectral channels.</p>
<ul>
<li><p>If set to <code>-1.0</code>, the maximum scaling for each of the 3 <code>RGB</code> channels will be set to the maximum non-zero value found in those channels (actual stretching).</p></li>
<li><p>If set to <code>0.0</code> (or not set), the maximum scaling for each of the 3 <code>RGB</code> channels will be set to <code>0.35</code> (standard stretching).</p></li>
<li><p>If set to a positive value, the maximum scaling for each of the 3 <code>RGB</code> channels will be set to the indicated value (specified stretching).</p></li>
</ul></li>
<li><p><code>SCL_NIR_MIN = scl_nir_min {FLOAT} [I] (Default value: 0.0):</code><br />
The smallest unscaled <span class="smallcaps">L1B2</span> GRP ToA radiance to be mapped in the <span class="smallcaps">NIR</span> spectral channel.</p>
<ul>
<li><p>If set to <code>-1.0</code>, the minimum scaling for the <span class="smallcaps">NIR</span> channel will be set to the minimum non-zero value found in that channel (actual stretching).</p></li>
<li><p>If set to <code>0.0</code> (or not set), the minimum scaling for the <span class="smallcaps">NIR</span> channel will be set to <code>0.0</code> (standard stretching).</p></li>
<li><p>If set to a positive value, the minimum scaling for the <span class="smallcaps">NIR</span> channel will be set to the indicated value (specified stretching).</p></li>
</ul></li>
<li><p><code>SCL_NIR_MAX = scl_nir_max {FLOAT} [I] (Default value: 0.50):</code><br />
The largest unscaled <span class="smallcaps">L1B2</span> GRP ToA radiance to be mapped in the <span class="smallcaps">NIR</span> spectral channel.</p>
<ul>
<li><p>If set to <code>-1.0</code>, the maximum scaling for the <span class="smallcaps">NIR</span> channel will be set to the maximum non-zero value found in that channel (actual stretching).</p></li>
<li><p>If set to <code>0.0</code> (or not set), the maximum scaling for the <span class="smallcaps">NIR</span> channel will be set to <code>0.5</code> (standard stretching).</p></li>
<li><p>If set to a positive value, the maximum scaling for the <span class="smallcaps">NIR</span> channel will be set to the indicated value (specified stretching).</p></li>
</ul></li>
<li><p><code>RGB_LOW = rgb_low {INTEGER} [I] (Default value: 1):</code> If set (for <code>GM</code> data, and for off-nadir pointing cameras only), this keyword requests that the <span class="smallcaps">Red</span> spectral channel be averaged first to 1.1 km and that the resulting <code>RGB</code> map be upsized to 275 m by replicating pixel values.</p></li>
<li><p><code>RGB_HIGH = rgb_high {INTEGER} [I] (Default value: 0):</code> If set (for <code>GM</code> data, and for off-nadir pointing cameras only), this keyword requests that the non-<span class="smallcaps">Red</span> spectral channels be upsized first to 275 m by replicating pixel values before generating the <code>RGB</code> map.</p></li>
<li><p><code>PER_BAND = per_band {INTEGER} [I] (Default value: 0):</code> If set (for all cameras), this keyword requests that data from each of the available spectral bands be mapped separately in black and white. All maps are generated at the full spatial resolution, where the Global Mode fields available only at the low resolution are upsized by duplication.</p></li>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> Flag to activate (<code>non-empty STRING</code>) or skip (<code>empty STRING</code>) artificially introducing missing data in the L1B2 data buffer; if set, this keyword is used in output file names to label experiments.</p></li>
<li><p><code>FIRST_LINE = first_line {INT array of 36 elements} [I] (Default value: 36 elements set to -1):</code> The index (between 0 and 127 [for GM data] or 511 [for LM data]) of the first line to be replaced by missing data, in the corresponding cameras and spectral bands. Values outside that range are ignored.</p></li>
<li><p><code>LAST_LINE = last_line {INT array of 36 elements} [I] (Default value: 36 elements set to -1):</code> The index (between 0 and 127 [for GM data] or 511 [for LM data]) of the last line to be replaced by missing data, in the corresponding cameras and spectral bands. Values outside that range are ignored.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the processing log.</p></li>
<li><p><code>MAP_BRF = map_brf {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the <span class="smallcaps">L1B2</span> Brf data product.</p></li>
<li><p><code>MAP_QUAL = map_qual {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the quality indicator (RDQI) of the <span class="smallcaps">L1B2</span> radiance data product.</p></li>
<li><p><code>MAP_FOLDER = map_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the maps.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. If all output options are turned on, this function generates and saves 197 (181) files in the default or the specified output folder for <span class="smallcaps">GM</span> (<span class="smallcaps">LM</span>) input, distributed as follows:</p>
<ul>
<li><p>18 <code>.png</code> files contain the colorbars for <span class="smallcaps">L1B2</span> <span class="smallcaps">Brf</span> maps.</p></li>
<li><p>89 (81) files contain the legends of the corresponding maps.</p></li>
<li><p>1 log file reports on the processing and contains information on the contents of the <span class="smallcaps">L1B2</span> files.</p></li>
<li><p>36 files contain the <span class="smallcaps">RDQI</span> maps.</p></li>
<li><p>53 (45) files contain the <span class="smallcaps">Brf</span> maps, for individual channels as well as for RGB composites.</p></li>
</ul>
<p>When <span class="smallcaps">LM</span> data are mapped, there are slightly fewer files because all data are at the full spatial resolution, so there are only 81 files and legends.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The log file, maps and colorbars may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Warning 98: The computer has not been recognized by the function<br />
<code>get_host_info.pro</code>.</p></li>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: One or more of the input positional parameters <code>misr_ptr</code>, <code>radrd_ptr</code>, <code>brf_ptr</code>, or <code>rdqi_ptr</code> is not of type <code>POINTER</code>.</p></li>
<li><p>Error 120: One or more of the input positional parameters <code>radrd_ptr</code>, <code>brf_ptr</code>, or <code>rdqi_ptr</code> is not an array.</p></li>
<li><p>Error 130: One or more of the input positional parameters <code>radrd_ptr</code>, <code>brf_ptr</code>, or <code>rdqi_ptr</code> does not contain 36 elements.</p></li>
<li><p>Error 140: The input positional parameter <code>prefix</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 150: The input positional parameter <code>n_masks</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in function <code>orbit2date.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and at least one of the optional input keyword parameters <code>log_folder</code>, <code>map_folder</code> is not specified.</p></li>
<li><p>Error 400: The output folder <code>map_fpath</code> is unwritable.</p></li>
<li><p>Error 410: The output folder <code>log_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>hr2lr.pro</code>.</p></li>
<li><p>Error 510: An exception condition occurred in function <code>lr2hr.pro</code>.</p></li>
<li><p>Error 520: An exception condition occurred in function <code>lr2hr.pro</code>.</p></li>
<li><p>Error 530: An exception condition occurred in function <code>lr2hr.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>get_host_info.pro</code></p></li>
<li><p><code>hr2lr.pro</code></p></li>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>str2block.pro</code></p></li>
<li><p><code>str2orbit.pro</code></p></li>
<li><p><code>str2path.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> The optional input keyword parameters <code>MAP_BRF</code> and <code>MAP_QUAL</code> permit the selective generation of maps. If neither of these keywords is set, no maps are generated, but if both keywords are set, 197 files are generated. A text file with the map legend is generated for each map that is produced.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39;GM&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 65487L
IDL&gt; misr_block = 110
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = heap_l1b2_block(misr_mode, misr_path, $
   misr_orbit, misr_block, misr_ptr, radrd_ptr, $
   rad_ptr, brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; prefix = &#39;test&#39;
IDL&gt; n_masks = 0
IDL&gt; scl_rgb_min = 0.0
IDL&gt; scl_rgb_max = 0.0
IDL&gt; scl_nir_min = 0.0
IDL&gt; scl_nir_max = 0.0
IDL&gt; rgb_low = 1
IDL&gt; rgb_high = 1
IDL&gt; per_band = 1
IDL&gt; log_it = 1
IDL&gt; log_folder = &#39;&#39;
IDL&gt; map_brf = 1
IDL&gt; map_qual = 1
IDL&gt; map_folder = &#39;&#39;
IDL&gt; rc = map_l1b2(misr_ptr, radrd_ptr, brf_ptr, $
   rdqi_ptr, prefix, N_MASKS = n_masks, $
   SCL_RGB_MIN = scl_rgb_min, SCL_RGB_MAX = scl_rgb_max, $
   SCL_NIR_MIN = scl_nir_min, SCL_NIR_MAX = scl_nir_max, $
   RGB_LOW = rgb_low, RGB_HIGH = rgb_high, $
   PER_BAND = per_band, LOG_IT = log_it, $
   LOG_FOLDER = log_folder, MAP_BRF = map_brf, $
   MAP_QUAL = map_qual, MAP_FOLDER = map_folder, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
Saved ~/MISR_HR/Outcomes/
   P168-O065487-B110/GM/L1B2/Maps_L1B2/
   Log_L1B2_test-map-nm0_GM-P168-O065487-
   B110_2012-04-10_2019-10-27.txt
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc)
rc = 0</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;28: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;03&#8211;07: Version 2.00 &#8212; Include the <code>MAP_BRF</code> and <code>MAP_POORBAD</code> keyword parameters, merge the codes originally found in functions <code>map_l1b2_block.pro</code> and <code>map_l1b2_miss.pro</code>, and initial public release.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;05: Version 2.11 &#8212; Update the code to accept the variable <code>n_masks</code> as a keyword rather than a positional parameter, and expand the allowed range of values to <code>[0, 3]</code>.</p></li>
<li><p>2019&#8211;04&#8211;18: Version 2.12 &#8212; Add code to set the <code>BUFFER</code> keyword parameter as a function of the <code>VERBOSE</code> keyword parameter, re-dimension the colorbars and insert them in the right edge area of the corresponding B&amp;W maps, and generate a legend for each map.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.13 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements, deprecate the keyword parameter <code>MAP_POORBAD</code> as the quality maps now show all values of <span class="smallcaps">RDQI</span>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;16: Version 2.1.1 &#8212; Improve the log file, update the documentation, add the keywords <code>TEST_ID</code>, <code>FIRST_LINE</code> and <code>LAST_LINE</code> to include additional information in the map legends whenever missing data have been artificially inserted in the <span class="smallcaps">L1B2</span> data buffers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.2 &#8212; Update the code to modify the default log and map output directories, and use the current version of the function <code>hr2lr.pro</code>.</p></li>
</ul></li>
</ul>
<h2>mk_l1b2_masks</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates and saves on the heap a set of 36 output masks of the spatial distribution of geophysical media in the scene, one for each camera and spectral band, for the selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> area. The number and nature of these media is controlled by the input positional parameter <code>n_masks</code>, which can only take the values <code>1</code>, <code>2</code> or <code>3</code>, as described below. These masks are provided at the same spatial resolution as the original <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Global Mode <span class="smallcaps">GRP</span> data products.</p></li>
<li><p><strong>Algorithm:</strong> This function defines a pointer array <code>lwc_mask_ptr[9, 4]</code> where each element points to an array containing a mask dimensioned either <code>[512, 128]</code> or <code>[2048, 512]</code>, depending on the spatial resolution of the corresponding <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> <span class="smallcaps">GRP</span> data product, and taking on the following values:</p>
<ul>
<li><p><code>IF (n_masks EQ 1)</code>, the 36 output masks attribute all observable areas to land (<code>1B</code>), while areas obscured by topography or belonging to the edges of the <span class="smallcaps">Block</span> are reported as <code>253B</code> and <code>254B</code>, respectively.</p></li>
<li><p><code>IF (n_masks EQ 2)</code>, the 36 output masks defined above (for <code>n_masks EQ 1</code>) are updated to attribute the value <code>2B</code> to all observable water bodies (oceans and deep inland water), as reported in the <span class="smallcaps">AGP</span> data file for the specified <span class="smallcaps">Block</span>.</p></li>
<li><p><code>IF (n_masks EQ 3)</code>, the 36 output masks defined above (for <code>n_masks EQ 2</code>) are further updated to attribute the value <code>3B</code> to all observable areas occupied by cloud fields in the <span class="smallcaps">RCCM</span> data product for the same <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, <span class="smallcaps">Block</span> and <span class="smallcaps">Camera</span> area.</p></li>
</ul></li>
<li><p><strong>Syntax:</strong> <code>rc = mk_l1b2_masks(misr_ptr, radrd_ptr, $</code><br />
<code>n_masks, lwc_mask_ptr, $</code><br />
<code>AGP_FOLDER = agp_folder, AGP_VERSION = agp_version, $</code><br />
<code>RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $</code><br />
<code>MAP_IT = map_it, MAP_FOLDER = map_folder, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, <span class="smallcaps">Block</span> and <span class="smallcaps">Version</span> to be processed.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the <code>UINT</code> data buffers containing the <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF to DA and Blue to NIR).</p></li>
<li><p><code>n_masks {INT} [I]:</code> The number of target types that need to be discriminated by the masks: <code>1</code> to generate a single mask for all geophysical target types, <code>2</code> to generate masks separately for land masses and water bodies, or <code>3</code> to generate masks separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><code>lwc_mask_ptr {POINTER array} [O]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the <code>BYTE</code> masks containing the information on the spatial distribution of geophysical media to consider, as defined by <code>n_masks</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>AGP_FOLDER = agp_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">AGP</span> files, if they are not located in the default location.</p></li>
<li><p><code>AGP_VERSION = agp_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">AGP</span> version identifier to use instead of the default value.</p></li>
<li><p><code>RCCM_FOLDER = rccm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> files, if they are not located in the default location.</p></li>
<li><p><code>RCCM_VERSION = rccm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">RCCM</span> version identifier to use instead of the default value.</p></li>
<li><p><code>MAP_IT = map_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating maps of the numerical results; this currently generates only the <code>RCCM</code> maps.</p></li>
<li><p><code>MAP_FOLDER = map_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the maps.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>lwc_mask_ptr</code> points to the 36 masks for the specified inputs.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>lwc_mask_ptr</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_ptr</code> is not a pointer.</p></li>
<li><p>Error 120: The input positional parameter <code>radrd_ptr</code> is not a pointer array.</p></li>
<li><p>Error 130: The input positional parameter <code>n_masks</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: An exception condition occurred in <code>orbit2date.pro</code>.</p></li>
<li><p>Error 400: The directory <code>map_fpath</code> is unwritable.</p></li>
<li><p>Error 500: An exception condition occurred in <code>mk_water_land_masks.pro</code>.</p></li>
<li><p>Error 510: An exception condition occurred in <code>fix_rccm.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>fix_rccm.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>make_bytemap.pro</code></p></li>
<li><p><code>mk_water_land_masks.pro</code></p></li>
<li><p><code>orbit2date.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strcat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
<li><p><code>str2block.pro</code></p></li>
<li><p><code>str2orbit.pro</code></p></li>
<li><p><code>str2path.pro</code></p></li>
<li><p><code>today.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function generates the output masks at the same spatial resolution as the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Global Mode databuffers, even though the <span class="smallcaps">AGP</span> and the <span class="smallcaps">RCCM</span> inputs are only available at the reduced spatial resolution, in order to report the obscured area at the full spatial resolution whenever possible.</p></li>
<li><p><strong>Note 2:</strong> If this function is called as part of processing Local Mode data, the output masks of the non-red data channels in the off-nadir cameras must subsequently be upscaled explicitly to the full spatial resolution.</p></li>
<li><p><strong>Note 3:</strong> If maps are required, the reduced spatial resolution masks will be upscaled to the same size as the full spatial resolution masks with the function <code>lr2hr</code> to facilitate comparisons.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; misr_block = 113
IDL&gt; rc = find_l1b2gm_files(misr_path, misr_orbit, l1b2gm_files, $
   L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; rc = heap_l1b2_block(l1b2_files, misr_block, misr_ptr, $
   radrd_ptr, rad_ptr, brf_ptr, rdqi_ptr, scalf_ptr, convf_ptr, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; n_masks = 3
IDL&gt; rc = mk_l1b2_masks(misr_ptr, radrd_ptr, n_masks, lwc_mask_ptr, $
   AGP_FOLDER = agp_folder, AGP_VERSION = agp_version, $
   RCCM_FOLDER = rccm_folder, RCCM_VERSION = rccm_version, $
   MAP_IT = map_it, MAP_FOLDER = map_folder, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39;, rc, &#39; excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc =        0 excpt_cond = &gt;&lt;</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;08&#8211;27: Version 0.8 &#8212; Initial release.</p></li>
<li><p>2018&#8211;09&#8211;19: Version 0.9 &#8212; Update the code to use the most current version of the function <code>make_cloud_masks.pro</code>.</p></li>
<li><p>2018&#8211;09&#8211;26: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;01&#8211;26: Version 1.1 &#8212; Update and complement a full set of input keyword parameters, update the documentation.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.11 &#8212; Update the function to generate 36 masks instead of 9, and save those on the heap; change the name of this function from <code>mk_l1b2_mask.pro</code> to <code>mk_l1b2_masks.pro</code>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;25: Version 2.1.1 &#8212; Update the code to use the latest version of <code>fix_rccm.pro</code> and to modify the default map output directory.</p></li>
<li><p>2019&#8211;10&#8211;24: Version 2.1.2 &#8212; Update the documentation to clarify the fact that the output masks are always generated at the spatial resolution of Global Mode <span class="smallcaps">L1B2</span> databuffers. Masks for the non-red off-nadir data channels should be upscaled after calling this function when processing Local Mode data.</p></li>
</ul></li>
</ul>
<h2>mpocv2fn_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance file specification (path and name) corresponding to the input arguments <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span> and <span class="smallcaps">Orbit</span> numbers, the <span class="smallcaps">Camera</span> name and the version number.</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> function <code>MTK_MAKE_FILENAME</code> to generate the desired <span class="smallcaps">L1B2</span> Georectified Radiance Product (GRP) Terrain-Projected Top of Atmosphere (ToA) Radiance output filename, and prepends the appropriate directory address on the current computer.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = mpocv2fn_l1b2(misr_mode, misr_path, misr_orbit, $</code><br />
<code>misr_camera, misr_version, l1b2_fspec, DEBUG = debug, $</code><br />
<code>EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>.</p></li>
<li><p><code>misr_path {INTEGER} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>misr_orbit {LONG} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Orbit</span> number.</p></li>
<li><p><code>misr_camera {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> &#160;name.</p></li>
<li><p><code>misr_version STRING [I]:</code> The <span class="smallcaps">MISR</span> file version number.</p></li>
<li><p><code>l1b2_fspec {STRING} [O]:</code> The name of the corresponding <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA radiance file.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The output argument <code>l1b2_fspec</code> contains the name of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> GRP ToA radiance file.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output argument <code>l1b2_fspec</code> may be undefined, incomplete or useless.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: Input argument <code>misr_mode</code> is invalid.</p></li>
<li><p>Error 120: Input argument <code>misr_path</code> is invalid.</p></li>
<li><p>Error 130: Input argument <code>misr_orbit</code> is invalid.</p></li>
<li><p>Error 132: The input positional parameter <code>misr_orbit</code> is inconsistent with the input positional parameter <code>misr_path</code>.</p></li>
<li><p>Error 134: An exception condition occurred in <code>is_frompath.pro</code>.</p></li>
<li><p>Error 136: Unexpected return code received from <code>is_frompath.pro</code>.</p></li>
<li><p>Error 140: Input argument <code>misr_camera</code> is invalid.</p></li>
<li><p>Error 199: Unrecognized computer: Update the function <code>set_root_dirs</code>.</p></li>
<li><p>Error 200: An exception condition occurred in <code>path2str.pro</code>.</p></li>
<li><p>Error 600: An exception condition occurred in the <span class="smallcaps">MISR</span> <span class="smallcaps">Toolkit</span> routine<br />
<code>MTK_MAKE_FILENAME</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>MISR Toolkit</code></p></li>
<li><p><code>chk_misr_camera.pro</code></p></li>
<li><p><code>chk_misr_mode.pro</code></p></li>
<li><p><code>chk_misr_orbit.pro</code></p></li>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>is_frompath.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function works equally well with <span class="smallcaps">GM</span> and <span class="smallcaps">LM</span> files.</p></li>
<li><p><strong>Note 2:</strong> This function performs the reverse operation of <code>fn2pocv_l1b2.pro</code>.</p></li>
<li><p><strong>Note 3:</strong> This function does not check whether the resulting fialename corresponds to an existing or readable file on the current computer.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_mode = &#39;LM&#39;
IDL&gt; misr_path = 168
IDL&gt; misr_orbit = 68050
IDL&gt; misr_camera = &#39;CF&#39;
IDL&gt; misr_version = &#39;F03_0024&#39;
IDL&gt; rc = mpocv2fn_l1b2(misr_mode, misr_path, $
   misr_orbit, misr_camera, misr_version, l1b2_fspec, $
   /DEBUG, EXCPT_COND = excpt_cond)
IDL&gt; PRINT, &#39;rc = &#39; + strstr(rc) + $
   &#39; and excpt_cond = &gt;&#39; + excpt_cond + &#39;&lt;&#39;
rc = 0 and excpt_cond = &gt;&lt;
IDL&gt; PRINT, &#39;l1b2_fspec = &#39; + l1b2_fspec
l1b2_fspec = /Volumes/MISR_Data3/P168/L1_LM/
   MISR_AM1_GRP_TERRAIN_LM_P168_O068050_CF_F03_0024.hdf</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2017&#8211;09&#8211;03: Version 0.9 &#8212; Initial release under the name <code>pocv2fn_l1b2_gm.pro</code></p></li>
<li><p>2018&#8211;01&#8211;30: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;04&#8211;08: Version 1.1 &#8212; Update this function to use <code>set_root_dirs.pro</code> instead of <code>set_misr_roots.pro</code>, and add a test to verify the existence of the specified file at the expected location.</p></li>
<li><p>2018&#8211;05&#8211;07: Version 1.2 &#8212; Add the <code>misr_mode</code> input positional parameter, merge this function with its twin <code>pocv2fn_l1b2_lm.pro</code> and change the name to<br />
<code>pocv2fn_l1b2.pro</code>.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;12&#8211;12: Version 1.6 &#8212; Update this function to use <code>set_roots_vers.pro</code> instead of <code>set_root_dirs.pro</code>.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;04&#8211;11: Version 2.01 &#8212; Bug fix: correct an error message on line 300.</p></li>
<li><p>2019&#8211;05&#8211;04: Version 2.02 &#8212; Update the code to report the specific error message of MTK routines.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.03 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>plot_l1b2gm_miss</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates a time series plot of the number of missing <span class="smallcaps">L1B2</span> values found in the 9 cameras of all available <span class="smallcaps">Orbits</span> for the <span class="smallcaps">MISR</span> <span class="smallcaps">GRP</span> Global Mode <span class="smallcaps">Path</span> and <span class="smallcaps">Block</span> specified in the file name <code>in_fspec</code>, which is assumed to have been generated by the function <code>count_l1b2gm_miss_poor.pro</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function reads the file provided by the input positional parameter <code>in_fspec</code> and saves the time series plot of the total number of missing <span class="smallcaps">L1B2</span> values for each processed <span class="smallcaps">Orbit</span>. By default, this plot is saved in the same folder as this input file. If the optional keyword parameter <code>OUT_FOLDER</code> is specified, it supersedes the default directory and the plot is saved in that folder instead. If the optional keyword parameter <code>SEMI_LOG</code> is set, then two plots are generated: one with a linear and one with a logarithmic scale on the <code>Y</code> axis. In this latter case, the minimum number of missing values for the purpose of plotting is set to <code>1</code>. The name(s) of the plot file(s) is(are) similar to the name of the input file, and include an extra field to indicate whether the plot is linear (<code>_lin</code>) or semi-logarithmic (<code>_slog</code>); the plot file extension(s) is(are) <code>.png</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = plot_l1b2gm_miss(in_fspec, $</code><br />
<code>SEMI_LOG = semi_log, OUT_FILE = out_file, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>in_fspec {STRING} [I]:</code> The full file specification (path and name) of the file containing the results generated by the function <code>count_l1b2gm_miss_poor.pro</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>SEMI_LOG = semi_log {STRING} [I] (Default value: 0)</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating the semi-logarithmic plot of the time series.</p></li>
<li><p><code>OUT_FOLDER = out_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the output file(s).</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The time series plot(s) of the missing L1B2 values is(are) saved in the default or specified folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The time series plot(s) of the missing L1B2 values may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>in_fspec</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 300: The input file <code>in_fspec</code> does not exist, is not a regular file or is not readable.</p></li>
<li><p>Error 310: The input file <code>in_fspec</code> is not recognized as a <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> file.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>set_year_range.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function assumes that the input data file <code>in_fspec</code> was generated by the function <code>count_l1b2gm_miss_poor.pro</code>, and therefore to the particular output format specified in that function.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; in_fspec = &#39;~/MISR_HR/Outcomes/GM-P168-B110/
   Num_L1B2_miss_P168-B110_2000-03-24_2018-12-23.txt&#39;
IDL&gt; semi_log = 1
IDL&gt; rc = plot_l1b2gm_miss(in_fspec, SEMI_LOG = semi_log, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
The linear time series plot has been saved in
   ~/MISR_HR/Outcomes/GM-P168-B110/
   Num_L1B2_miss_P168-B110_2000-03-24_2018-12-23_lin.png
The semi-logarithmic time series plot has been saved in
   ~/MISR_HR/Outcomes/GM-P168-B110/
   Num_L1B2_miss_P168-B110_2000-03-24_2018-12-23_slog.png</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;01: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;05&#8211;06: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>plot_l1b2gm_poor</h2>
<ul>
<li><p><strong>Purpose:</strong> This function generates a time series plot of the number of poor <span class="smallcaps">L1B2</span> values found in the 9 cameras of all available <span class="smallcaps">Orbits</span> for the <span class="smallcaps">MISR</span> <span class="smallcaps">GRP</span> Global Mode <span class="smallcaps">Path</span> and <span class="smallcaps">Block</span> specified in the file name <code>in_fspec</code>, which is assumed to have been generated by the function <code>count_l1b2gm_miss_poor.pro</code>.</p></li>
<li><p><strong>Algorithm:</strong> This function reads the file provided by the input positional parameter <code>in_fspec</code> and saves the time series plot of the total number of poor <span class="smallcaps">L1B2</span> values for each processed <span class="smallcaps">Orbit</span>. By default, this plot is saved in the same folder as this input file. If the optional keyword parameter <code>OUT_FOLDER</code> is specified, it supersedes the default directory and the plot is saved in that folder instead. If the optional keyword parameter <code>SEMI_LOG</code> is set, then two plots are generated: one with a linear and one with a logarithmic scale on the <code>Y</code> axis. In this latter case, the minimum number of poor values for the purpose of plotting is set to <code>1</code>. The name(s) of the plot file(s) is(are) similar to the name of the input file, and include an extra field to indicate whether the plot is linear (<code>_lin</code>) or semi-logarithmic (<code>_slog</code>); the plot file extension(s) is(are) <code>.png</code>.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = plot_l1b2gm_poor(in_fspec, $</code><br />
<code>SEMI_LOG = semi_log, OUT_FILE = out_file, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>in_fspec {STRING} [I]:</code> The full file specification (path and name) of the file containing the results generated by the function <code>count_l1b2_miss_poor.pro</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>SEMI_LOG = semi_log {STRING} [I] (Default value: 0)</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating the semi-logarithmic plot of the time series.</p></li>
<li><p><code>OUT_FOLDER = out_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the output file(s).</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The time series plot(s) of the poor L1B2 values is(are) saved in the default or specified folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The time series plot(s) of the poor L1B2 values may be inexistent, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>in_fspec</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 300: The input file <code>in_fspec</code> does not exist, is not a regular file or is not readable.</p></li>
<li><p>Error 310: The input file <code>in_fspec</code> is not recognized as a <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> file.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_file.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>set_year_range.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function assumes that the input data file <code>in_fspec</code> was generated by the function <code>count_l1b2_poor_poor.pro</code>, and therefore to the particular output format specified in that function.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; in_fspec = &#39;~/MISR_HR/Outcomes/GM-P168-B110/
   Num_L1B2_poor_P168-B110_2000-03-24_2018-12-23.txt&#39;
IDL&gt; semi_log = 1
IDL&gt; rc = plot_l1b2gm_poor(in_fspec, SEMI_LOG = semi_log, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
The linear time series plot has been saved in
   ~/MISR_HR/Outcomes/GM-P168-B110/
   Num_L1B2_poor_P168-B110_2000-03-24_2018-12-23_lin.png
The semi-logarithmic time series plot has been saved in
   ~/MISR_HR/Outcomes/GM-P168-B110/
   Num_L1B2_poor_P168-B110_2000-03-24_2018-12-23_slog.png</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;01: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;05&#8211;06: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
</ul></li>
</ul>
<h2>plt_scatt_gen</h2>
<ul>
<li><p><strong>Purpose:</strong> This function plots the scatter diagram of a pair of MISR L1B2 channels (against each other), optionally with information about their statistical relation. The input positional parameter <code>array_1</code> refers to the independent variable (<span class="math inline"><em>X</em></span> axis), while the input positional parameter <code>array_2</code> designates the dependent variable (<span class="math inline"><em>Y</em></span> axis).</p></li>
<li><p><strong>Algorithm:</strong> This function relies on the <code>IDL</code> functions <code>SCATTERPLOT</code> and <code>PLOT</code> to generate the required exhibit; the optional statistical information is provided through input keyword parameters.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = plt_scatt_gen(array_1, array_1_title, $</code><br />
<code>array_2, array_2_title, CORRCOEFF = corrcoeff, $</code><br />
<code>mpob_str, mpobcb_str, NPTS = npts, RMSD = rmsd, $</code><br />
<code>LIN_COEFF_A = lin_coeff_a, LIN_COEFF_B = lin_coeff_b, $</code><br />
<code>CHISQR = chisqr, PROB = prob, SET_MIN_SCATT = set_min_scatt, $</code><br />
<code>SET_MAX_SCATT = set_max_scatt, PREFIX = prefix, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>array_1 {FLOAT} [I]:</code> The values of the source <code>(x)</code> <span class="smallcaps">MISR</span> data channel.</p></li>
<li><p><code>array_1_title {STRING} [I]:</code> The label of the <code>(x)</code> axis.</p></li>
<li><p><code>array_2 {FLOAT} [I]:</code> The values of the target <code>(y)</code> <span class="smallcaps">MISR</span> data channel.</p></li>
<li><p><code>array_2_title {STRING} [I]:</code> The label of the <code>(y)</code> axis.</p></li>
<li><p><code>title {STRING} [I]:</code> The title of the scatterplot figure.</p></li>
<li><p><code>mpob_str {STRING} [I]:</code> A string formatted as<br />
<code>mM-Pxxx-Oyyyyyy-Bzzz</code>, indicating the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> concerned.</p></li>
<li><p><code>mpobcb_str {STRING} [I]:</code> A string formatted as<br />
<code>mM-Pxxx-Oyyyyyy-Bzzz-[cam]-[bnd]</code>, indicating the target <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span>, <span class="smallcaps">Block</span>, <span class="smallcaps">Camera</span> and <span class="smallcaps">Band</span>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>NPTS = npts {LONG} [I] (Default value: None):</code> The number of data points used to compute the statistics.</p></li>
<li><p><code>RMSD = rmsd {FLOAT} [I] (Default value: None):</code> The Root Mean Square Difference between the two data channels.</p></li>
<li><p><code>CORRCOEFF = corrcoeff {FLOAT} [I] (Default value: None):</code> The Pearson<br />
correlation coefficient between the two data channels.</p></li>
<li><p><code>LIN_COEFF_A = lin_coeff_a {FLOAT} [I] (Default value: None):</code> The intercept coefficient of the linear fit equation between <code>array_1</code> and <code>array_2</code>.</p></li>
<li><p><code>LIN_COEFF_B = lin_coeff_b {FLOAT} [I] (Default value: None):</code> The slope coefficient of the linear fit equation between <code>array_1</code> and <code>array_2</code>.</p></li>
<li><p><code>CHISQR = chisqr {DOUBLE} [I] (Default value: None):</code> The value of the Chi square statistics associated with the linear fit equation.</p></li>
<li><p><code>PROB = prob {FLOAT} [I] (Default value: None):</code> Probability that the computed fit would have a value of <code>CHISQR</code> or greater.</p></li>
<li><p><code>SET_MIN_SCATT = set_min_scatt {STRING} [I] (Default value: None):</code> The minimum value to be used on the <code>X</code> and <code>Y</code> axes of the histograms. WARNING: This value must be provided as a <code>STRING</code> because the value <code>0.0</code> is frequently desirable as the minimum for the scatterplot, but that numerical value would be misinterpreted as NOT setting the keyword.</p></li>
<li><p><code>SET_MAX_SCATT = set_max_scatt {STRING} [I] (Default value: None):</code> The maximum value to be used on the <code>X</code> and <code>Y</code> axes of the histograms. WARNING: By analogy with <code>set_min_scatt</code>, this value must be provided as a <code>STRING</code> because the value <code>0.0</code> is frequently desirable as the minimum for the scatterplot, but that numerical value would be misinterpreted as NOT setting the keyword.</p></li>
<li><p><code>SCATT_PATH = scatt_path {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the output folder containing the scatterplots.</p></li>
<li><p><code>PREFIX = prefix {INT} [I] (Default value: &#8217;Scatt_&#8217;):</code> Prefix to the name of the log and scatterplot output files.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> was set and if the optional output keyword parameter <code>EXCPT_COND</code> was provided in the call. The scatterplot and optionally the log file are saved in the expected folder.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The scatterplot and the log file may not exist.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>array_1</code> is not a numeric array.</p></li>
<li><p>Error 120: The input positional parameter <code>array_2</code> is not a numeric array.</p></li>
<li><p>Error 130: The input positional parameters <code>array_1</code> and <code>array_2</code> are of different sizes.</p></li>
<li><p>Error 140: The input positional parameter <code>array_1_title</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 150: The input positional parameter <code>array_2_title</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 160: The input positional parameter <code>title</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 170: The input positional parameter <code>mpob_str</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 180: The input positional parameter <code>mpobcb_str</code> is not of type <code>STRING</code>.</p></li>
<li><p>Error 199: Unrecognized computer: Update the function <code>set_root_dirs</code>.</p></li>
<li><p>Error 200: The optional keyword parameter <code>npts</code> is not of type <code>INTEGER</code>.</p></li>
<li><p>Error 210: The optional keyword parameter <code>rmsd</code> is not of a numeric type.</p></li>
<li><p>Error 220: The optional keyword parameter <code>corrcoeff</code> is not of a numeric type.</p></li>
<li><p>Error 230: The optional keyword parameter <code>lin_coeff_a</code> is not of a numeric type.</p></li>
<li><p>Error 240: The optional keyword parameter <code>lin_coeff_b</code> is not of a numeric type.</p></li>
<li><p>Error 250: The optional keyword parameter <code>chisqr</code> is not of a numeric type.</p></li>
<li><p>Error 260: The optional keyword parameter <code>prob</code> is not of a numeric type.</p></li>
<li><p>Error 270: The optional keyword parameter <code>set_min_scatt</code> is not provided as a numeric <code>STRING</code> value.</p></li>
<li><p>Error 280: The optional keyword parameter <code>set_max_scatt</code> is not provided as a numeric <code>STRING</code> value.</p></li>
<li><p>Error 400: The output folder <code>plot_fpath</code> is unwritable.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_array.pro</code></p></li>
<li><p><code>is_integer.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_numstring.pro</code></p></li>
<li><p><code>is_string.pro</code></p></li>
<li><p><code>is_writable_dir.pro</code></p></li>
<li><p><code>set_root_vers.pro</code></p></li>
<li><p><code>set_value_range.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function works equally well for <span class="smallcaps">GM</span> and <span class="smallcaps">LM</span> files.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See practical example in the output of function
best_fit_l1b2.pro.]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2018&#8211;05&#8211;02: Version 0.9 &#8212; Initial release.</p></li>
<li><p>2018&#8211;05&#8211;16: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2018&#8211;05&#8211;18: Version 1.5 &#8212; Implement new coding standards.</p></li>
<li><p>2018&#8211;08&#8211;07: Version 1.6 &#8212; Add the optional <code>SET_MIN_SCATT = set_min_scatt</code> keyword parameter.</p></li>
<li><p>2018&#8211;10&#8211;13: Version 1.7 &#8212; Change the output path to match the current organization of files.</p></li>
<li><p>2019&#8211;01&#8211;23: Version 1.8 &#8212; Add the optional <code>SET_MAX_SCATT = set_max_scatt</code> keyword parameter.</p></li>
<li><p>2019&#8211;03&#8211;01: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.11 &#8212; Add code to set the <code>BUFFER</code> keyword parameter as a function of the <code>VERBOSE</code> keyword parameter.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;30: Version 2.1.1 &#8212; Update the code to include annotations in scatterplots only when they take on finite values.</p></li>
<li><p>2019&#8211;10&#8211;24: Version 2.1.2 &#8212; Update the code to prevent a run time error when some of the optional keyword parameters are undefined.</p></li>
</ul></li>
</ul>
<h2>pre_fix_l1b2</h2>
<ul>
<li><p><strong>Purpose:</strong> This function identifies the <span class="smallcaps">L1B2</span> databuffers of the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span> that contain missing or optionally poor data, and computes the best linear fits statistics needed to replace those values.</p></li>
<li><p><strong>Algorithm:</strong> This function scans the radiance values (with the <span class="smallcaps">RDQI</span> attached) and the <span class="smallcaps">RDQI</span> field for each camera and spectral band of the specified <span class="smallcaps">MISR</span> <span class="smallcaps">Block</span>, detects whether one or more of these 36 data channels contains poor or missing data values, loads information on the numbers and locations of those values on the heap and calls the <code>best_fits_l1b2.pro</code> function when required to compute the optimal fitting functions for the appropriate land cover masks. If the optional input keyword parameters <code>MAIN_LOG_IT</code> is set, this function reports progress in the main output log file attached to the IDL logical unit <code>main_log_unit</code> (assumed to be open prior to calling this function).</p></li>
<li><p><strong>Syntax:</strong> <code>rc = pre_fix_l1b2(misr_ptr, radrd_ptr, $</code><br />
<code>rad_ptr, rdqi_ptr, lwc_mask_ptr, $</code><br />
<code>n_poor_lnd_ptr, idx_poor_lnd_ptr, $</code><br />
<code>n_poor_wat_ptr, idx_poor_wat_ptr, $</code><br />
<code>n_poor_cld_ptr, idx_poor_cld_ptr, $</code><br />
<code>n_miss_lnd_ptr, idx_miss_lnd_ptr, $</code><br />
<code>n_miss_wat_ptr, idx_miss_wat_ptr, $</code><br />
<code>n_miss_cld_ptr, idx_miss_cld_ptr, $</code><br />
<code>best_fits_ptr, N_MASKS = n_masks, $</code><br />
<code>ALSO_POOR = also_poor, TEST_ID = test_id, $</code><br />
<code>MAIN_LOG_IT = main_log_it, MAIN_LOG_UNIT = main_log_unit, $</code><br />
<code>LOG_IT = log_it, LOG_FOLDER = log_folder, $</code><br />
<code>SCATT_IT = scatt_it, SCATT_FOLDER = scatt_folder, $</code><br />
<code>SET_MIN_SCATT = set_min_scatt, SET_MAX_SCATT = set_max_scatt, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_ptr {POINTER} [I]:</code> The pointer to a <code>STRING</code> array containing metadata on the <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>, <span class="smallcaps">Path</span>, <span class="smallcaps">Orbit</span> and <span class="smallcaps">Block</span> of the next 3 pointer arrays.</p></li>
<li><p><code>radrd_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>UINT</code> <span class="smallcaps">L1B2</span> scaled radiance values (with the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>rad_ptr {POINTER array} [I]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>FLOAT</code> <span class="smallcaps">L1B2</span> unscaled radiance values (hence without the <span class="smallcaps">RDQI</span> attached), in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>rdqi_ptr {POINTER array} [O]:</code> The array of 36 pointers to the original <span class="smallcaps">MISR</span> data buffers containing the <code>BYTE</code> <span class="smallcaps">L1B2</span> <span class="smallcaps">RDQI</span> values, in the native order (DF/Blue to DA/NIR).</p></li>
<li><p><code>lwc_mask_ptr {POINTER array} [I]:</code> The array of 36 (9 cameras by 4 spectral bands) pointers to the <code>BYTE</code> masks containing the information on the spatial distribution of geophysical media to consider, as defined by <code>n_masks</code>.</p></li>
<li><p><code>n_poor_lnd_ptr {POINTER array} [O]:</code> The array of pointers to the number of poor pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_poor_lnd_ptr {POINTER array} [O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the poor pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_poor_wat_ptr {POINTER array} [O]:</code> The array of pointers to the number of poor pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_poor_wat_ptr {POINTER array} [O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the poor pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_poor_cld_ptr {POINTER array} [O]:</code> The array of pointers to the number of poor pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_poor_cld_ptr {POINTER array} [O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the poor pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_miss_lnd_ptr {POINTER array} [O]:</code> The array of pointers to the number of missing pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_miss_lnd_ptr {POINTER array} [O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the missing pixel values over land masses in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_miss_wat_ptr {POINTER array} [O]:</code> The array of pointers to the number of missing pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_miss_wat_ptr {POINTER array} [O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the missing pixel values over water bodies in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>n_miss_cld_ptr {POINTER array} [O]:</code> The array of pointers to the number of missing pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>idx_miss_cld_ptr {POINTER array} [O]:</code> The array of pointers to the vectors containing the one-dimensional subscripts of the missing pixel values over cloud fields in each of the 36 data channels of the input databuffer.</p></li>
<li><p><code>best_fits_ptr {POINTER array} [O]:</code> The array of pointers to the best fits statistics to replace poor or missing values in the 36 data channels of the input databuffer.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>N_MASKS = n_masks {INT} [I] (Default value: 3):</code> The number of target types that need to be discriminated by the masks: <code>1</code> to generate a single mask for all geophysical target types, <code>2</code> to generate masks separately for land masses and water bodies, or <code>3</code> to generate masks separately for clear land masses, clear water bodies and cloud fields.</p></li>
<li><p><code>ALSO_POOR = also_poor {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) replacing poor <span class="smallcaps">L1B2</span> values (i.e., those with RDQI = <code>2B</code>) by new estimates.</p></li>
<li><p><code>TEST_ID = test_id {STRING} [I] (Default value: &#8221;):</code> String to designate a particular experiment (e.g., to test the performance of the algorithm), used in the names of output files.</p></li>
<li><p><code>MAIN_LOG_IT = main_log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) writing intermediary results to a pre-existing log file.</p></li>
<li><p><code>MAIN_LOG_UNIT = main_log_unit {IDL Logical Unit Number} [I] (Default: None):</code> The IDL Logical Unit Number of the main log file, which must be opened for writing prior to calling this function.</p></li>
<li><p><code>LOG_IT = log_it {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) generating a log file for each call of the <code>best_fits_l1b2.pro</code> function.</p></li>
<li><p><code>LOG_FOLDER = log_folder {STRING} [I]:</code> The directory address of the output folder containing the processing log for each call of the <code>best_fits_l1b2.pro</code> function, if different from the value implied by the default set by function <code>set_roots_vers.pro)</code> and the routine arguments.</p></li>
<li><p><code>SCATT_IT = scatt_it {INT} [I] (Default value: 0):</code> Flag to generate (1) or skip (0) a scatterplot of the two best correlated data channels for each of the cases specified by <code>n_masks</code>.</p></li>
<li><p><code>SCATT_FOLDER = scatt_folder {STRING} [I]:</code> The directory address of the output folder containing the scatterplots, if different from the value implied by the default set by function <code>set_roots_vers.pro)</code> and the routine arguments.</p></li>
<li><p><code>SET_MIN_SCATT = set_min_scatt {STRING} [I] (Default value: None):</code> The minimum value to be used on the <code>X</code> and <code>Y</code> axes of the scatterplots. WARNING: This value must be provided as a <code>STRING</code> because the value <code>0.0</code> is frequently desirable as the minimum for the scatterplot, but that numerical value would be misinterpreted as NOT setting the keyword.</p></li>
<li><p><code>SET_MAX_SCATT = set_max_scatt {STRING} [I] (Default value: None):</code> The maximum value to be used on the <code>X</code> and <code>Y</code> axes of the scatterplots. WARNING: By analogy with <code>set_min_scatt</code>, this value must be provided as a <code>STRING</code>.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) outputting messages on the console:</p>
<ul>
<li><p>If <code>verbose &gt; 0</code>, messages inform the user about progress in the execution of time-consuming routines, or the location of output files (e.g., log, map, plot, etc.);</p></li>
<li><p>If <code>verbose &gt; 1</code>, messages record entering and exiting the routine; and</p></li>
<li><p>If <code>verbose &gt; 2</code>, messages provide additional information about intermediary results.</p></li>
</ul></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameters contain the results generated by this function.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameters may be incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: At least one of the following input positional parameters is not a pointer: <code>misr_ptr</code>, <code>radrd_ptr</code>, <code>rad_ptr</code>, <code>rdqi_ptr</code>, <code>lwc_mask_ptr</code>.</p></li>
<li><p>Error 500: An exception condition occurred in function <code>best_fits_l1b2.pro</code>.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>best_fits_l1b2.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_pointer.pro</code></p></li>
<li><p><code>lr2hr.pro</code></p></li>
<li><p><code>set_misr_specs.pro</code></p></li>
<li><p><code>strrepeat.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong> None.</p></li>
<li><p><strong>Examples:</strong></p>
<pre><code>[See the outcome(s) generated by fix_l1b2.pro]</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;02&#8211;28: Version 0.9 &#8212; Initial release of the function <code>fix_l1b2.pro</code>, from which this function is derived.</p></li>
<li><p>2019&#8211;03&#8211;06: Version 1.0 &#8212; Initial public release.</p></li>
<li><p>2019&#8211;03&#8211;08: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;03&#8211;19: Version 2.01 &#8212; Add the optional input keyword parameter <code>ALSO_POOR</code> to enable the user to replace poor data values in the same way as bad data values.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.02 &#8212; Upgrade the code to allow the use of the up to <code>N_ATTEMPTS</code> best statistical relations to replace the bad (missing) or poor (if requested) values, in case the first option is not applicable.</p></li>
<li><p>2019&#8211;03&#8211;20: Version 2.10 &#8212; Update the handling of the optional input keyword parameter <code>VERBOSE</code> and generate the software version consistent with the published documentation.</p></li>
<li><p>2019&#8211;04&#8211;06: Version 2.11 &#8212; Update the code to use the more detailed masks generated by the latest versions of <code>mk_l1b2_masks.pro</code> and <code>best_fits_l1b2.pro</code>.</p></li>
<li><p>2019&#8211;04&#8211;12: Version 2.12 &#8212; Update the code to use more explicit variable names for storing the results of best fits.</p></li>
<li><p>2019&#8211;04&#8211;19: Version 2.13 &#8212; Simplify the code by forcing <code>n_masks</code> to be <code>3</code>, i.e., by always distinguishing between clear land masses, clear water bodies and cloud fields, and add the pointers to the original <span class="smallcaps">MISR</span> data to the output positional parameter list.</p></li>
<li><p>2019&#8211;04&#8211;24: Version 2.14 &#8212; Adjust the code to use the new version of function <code>heap_l1b2_block.pro</code> which also returns the conversion factors, add the optional input keyword parameter <code>N_MASKS</code>, and add diagnostic information about the number of unusable source values and the the number of unusable negative replacement values in the log file.</p></li>
<li><p>2019&#8211;05&#8211;02: Version 2.15 &#8212; Bug fix: Encapsulate folder and file creation in <code>IF</code> statements.</p></li>
<li><p>2019&#8211;06&#8211;11: Version 2.16 &#8212; Update the code to include <code>ELSE</code> options in all <code>CASE</code> statements and update the documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.17 &#8212; Update the code to externalize the acquisition of <span class="smallcaps">L1B2</span> data (the function <code>heap_l1b2_block.pro</code> must be called only once prior to processing <span class="smallcaps">RCCM</span>, <span class="smallcaps">L1B2</span> or <span class="smallcaps">L1B3</span> data) and to allow the processing of Local Mode data (which does require an extra call to <code>heap_l1b2_block.pro</code>, as noted above).</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;09&#8211;17: Version 2.1.1 &#8212; Add the keywords <code>TEST_ID</code>, <code>FIRST_LINE</code> and <code>LAST_LINE</code> to include additional information in the map legends whenever missing data have been artificially inserted in the <span class="smallcaps">L1B2</span> data buffers.</p></li>
<li><p>2019&#8211;09&#8211;28: Version 2.1.2 &#8212; Update the code to modify the default log, map and savefile output directories, and use the current version of the function <code>hr2lr.pro</code>.</p></li>
<li><p>2019&#8211;10&#8211;23: Version 2.2.0 &#8212; Major rewrite of the function <code>fix_l1b2.pro</code>, breaking it up into smaller routines, including this one; update the code to properly handle Local Mode data.</p></li>
</ul></li>
</ul>
<h2>set_l1b2gm_folder</h2>
<ul>
<li><p><strong>Purpose:</strong> This function sets the path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files for the specified <span class="smallcaps">Path</span>.</p></li>
<li><p><strong>Algorithm:</strong> By default, this function sets the path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files according to the settings included in the function <code>set_roots_vers</code>; the optional input keyword parameter <code>l1b2gm_folder</code> overrides this setting. The function also checks that this folder is available for reading.</p></li>
<li><p><strong>Syntax:</strong> <code>rc = set_l1b2gm_folder(misr_mode, misr_path, $</code><br />
<code>l1b2gm_fpath, n_l1b2gm_files, $</code><br />
<code>L1B2GM_FOLDER = l1b2gm_folder, L1B2GM_VERSION = l1b2gm_version, $</code><br />
<code>VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)</code></p></li>
<li><p><strong>Positional parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>misr_mode {STRING} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Mode</span>.</p></li>
<li><p><code>misr_path {INT} [I]:</code> The selected <span class="smallcaps">MISR</span> <span class="smallcaps">Path</span> number.</p></li>
<li><p><code>l1b2gm_fpath {STRING} [O]:</code> The path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files for the specified <span class="smallcaps">Path</span>.</p></li>
<li><p><code>n_l1b2gm_files {LONG} [O]:</code> The number of <span class="smallcaps">L1B2</span> files residing in the <code>l1b2gm_folder</code>.</p></li>
</ul></li>
<li><p><strong>Keyword parameters [Input/Output]:</strong></p>
<ul>
<li><p><code>L1B2GM_FOLDER = l1b2gm_folder {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The directory address of the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files, if they are not located in the default location.</p></li>
<li><p><code>L1B2GM_VERSION = l1b2gm_version {STRING} [I] (Default value:</code> Set by function<br />
<code>set_roots_vers.pro):</code> The <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> version identifier to use instead of the default value.</p></li>
<li><p><code>VERBOSE = verbose {INT} [I] (Default value: 0):</code> Flag to enable (&gt; 0) or skip (0) reporting progress on the console: 1 only reports exiting the routine; 2 reports entering and exiting the routine, as well as key milestones; 3 reports entering and exiting the routine, and provides detailed information on the intermediary results.</p></li>
<li><p><code>DEBUG = debug {INT} [I] (Default value: 0):</code> Flag to activate (<code>1</code>) or skip (<code>0</code>) debugging tests.</p></li>
<li><p><code>EXCPT_COND = excpt_cond {STRING} [O] (Default value: &#8221;):</code> Description of the exception condition if one has been encountered, or a null string otherwise.</p></li>
</ul></li>
<li><p><strong>Returned value type:</strong> <code>INT</code>.</p></li>
<li><p><strong>Outcome:</strong></p>
<ul>
<li><p>If no exception condition has been detected, this function returns <code>0</code>, and the output keyword parameter <code>excpt_cond</code> is set to a null string, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided in the call. The output positional parameter <code>l1b2gm_fpath</code> contains the the path to the folder containing the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> files for the specified <span class="smallcaps">Path</span>.</p></li>
<li><p>If an exception condition has been detected, this function returns a non-zero error code, and the output keyword parameter <code>excpt_cond</code> contains a message about the exception condition encountered, if the optional input keyword parameter <code>DEBUG</code> is set and if the optional output keyword parameter <code>EXCPT_COND</code> is provided. The output positional parameter <code>l1b2gm_fpath</code> may be undefined, incomplete or incorrect.</p></li>
</ul></li>
<li><p><strong>Exception conditions:</strong></p>
<ul>
<li><p>Error 100: One or more positional parameter(s) are missing.</p></li>
<li><p>Error 110: The input positional parameter <code>misr_path</code> is invalid.</p></li>
<li><p>Error 199: An exception condition occurred in <code>set_roots_vers.pro</code>.</p></li>
<li><p>Error 200: Unrecognized <code>misr_mode</code> in a <code>CASE</code> statement.</p></li>
<li><p>Error 210: An exception condition occurred in function <code>path2str.pro</code>.</p></li>
<li><p>Error 299: The computer is not recognized and the optional input keyword parameter <code>l1b2gm_folder</code> is not specified.</p></li>
<li><p>Error 300: The folder <code>l1b2gm_fpath</code> is not found, is not a directory or is not readable.</p></li>
<li><p>Error 310: The folder <code>l1b2_path</code> does not contain any <span class="smallcaps">L1B2</span> files.</p></li>
</ul></li>
<li><p><strong>Dependencies:</strong></p>
<ul>
<li><p><code>chk_misr_path.pro</code></p></li>
<li><p><code>force_path_sep.pro</code></p></li>
<li><p><code>is_numeric.pro</code></p></li>
<li><p><code>is_readable_dir.pro</code></p></li>
<li><p><code>path2str.pro</code></p></li>
<li><p><code>set_roots_vers.pro</code></p></li>
<li><p><code>strstr.pro</code></p></li>
</ul></li>
<li><p><strong>Remarks:</strong></p>
<ul>
<li><p><strong>Note 1:</strong> This function does not currently distinguish between Ellipsoid and Terrain projected data. The <span class="smallcaps">MISR-HR</span> processing system focuses mainly on Terrain projected data.</p></li>
<li><p><strong>Note 2:</strong> This function ONLY handles Global Mode files, because Local Mode file names require the specification of a site name.</p></li>
</ul></li>
<li><p><strong>Examples:</strong></p>
<pre><code>IDL&gt; misr_path = 168
IDL&gt; l1b2gm_folder = &#39;&#39;
IDL&gt; l1b2gm_version = &#39;&#39;
IDL&gt; verbose = 1
IDL&gt; debug = 1
IDL&gt; rc = set_l1b2gm_folder(misr_path, $
   l1b2gm_fpath, n_l1b2gm_files, $
   L1B2GM_FOLDER = l1b2gm_folder, $
   L1B2GM_VERSION = l1b2gm_version, $
   VERBOSE = verbose, DEBUG = debug, EXCPT_COND = excpt_cond)
IDL&gt; IF (rc EQ 0) THEN $
   PRINT, &#39;Processing nominal: rc = &#39; + strstr(rc) + &#39;.&#39;
Processing nominal: rc = 0.
IDL&gt; PRINT, &#39;l1b2gm_fpath = &#39; + l1b2gm_fpath
l1b2gm_fpath = /Volumes/MISR_Data0/P168/L1_GM/
IDL&gt; PRINT, &#39;n_l1b2gm_files = &#39; + strstr(n_l1b2gm_files)
n_l1b2gm_files = 3861</code></pre></li>
<li><p><strong>References:</strong></p>
<ul>
<li><p>Michel Verstraete, Linda Hunt and Veljko M. Jovanovic (2019) <em>Improving the usability of the <span class="smallcaps">MISR</span> <span class="smallcaps">L1B2</span> Georectified Radiance Product (2000&#8211;present) in land surface applications</em>, <code>Earth System Science Data</code>, Vol. xxx, p. yy&#8211;yy, available from <a href="https://www.earth-syst-sci-data.net/essd-2019-zz/" class="uri">https://www.earth-syst-sci-data.net/essd-2019-zz/</a> (DOI: 10.5194/zzz).</p></li>
</ul></li>
<li><p><strong>Versioning:</strong></p>
<ul>
<li><p>2019&#8211;05&#8211;05: Version 1.0 &#8212; Initial release.</p></li>
<li><p>2019&#8211;05&#8211;06: Version 2.00 &#8212; Systematic update of all routines to implement stricter coding standards and improve documentation.</p></li>
<li><p>2019&#8211;08&#8211;10: Version 2.01 &#8212; Rename this function from <code>set_l1b2_folder.pro</code> to <code>set_l1b2gm_folder.pro</code>.</p></li>
<li><p>2019&#8211;08&#8211;20: Version 2.1.0 &#8212; Adopt revised coding and documentation standards (in particular regarding the use of <code>verbose</code> and the assignment of numeric return codes), and switch to 3-parts version identifiers.</p></li>
<li><p>2019&#8211;10&#8211;27: Version 2.1.1 &#8212; Delete input positional parameter <code>misr_mode</code> since this function applies only to Global Mode files, and update the documentation.</p></li>
</ul></li>
</ul>
</body>
</html>
